{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "60fc0b38",
   "metadata": {},
   "source": [
    "# INTRODUCTION"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8a322148",
   "metadata": {},
   "source": [
    "DIVVY is a bike-sharing public system based in Chicago and Evanston. Customers can rent bikes from a Divvy station and pay per minute of use until the bike is returned to any of the 625 stations. The main problem the service faces is to determine the optimal supply/demand of bikes per station per hour. For the service to function efficiently, transport trucks need to reallocate the bikes between stations to ensure demand can be covered optimally throughout the city. In other to do this, we need to identify the traffic per station, to ensure enough bikes are available for customers to rent out and spots are free for clients to return the bikes. In this report, we aim to provide the optimal transportation service system and schedule, taking into account the company’s constraints and optimizing the number of transports."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f215d62f",
   "metadata": {},
   "source": [
    "# IMPORT DATA"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "0157a223",
   "metadata": {},
   "outputs": [],
   "source": [
    "from gurobipy import *"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "54768a93",
   "metadata": {},
   "outputs": [],
   "source": [
    "from datascience import *\n",
    "import numpy as np\n",
    "import geopy.distance\n",
    "import calendar\n",
    "import math as math\n",
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plots\n",
    "plots.style.use('ggplot')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "d887d968",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>trip_id</th> <th>start_time</th> <th>end_time</th> <th>bikeid</th> <th>tripduration</th> <th>from_station_id</th> <th>from_station_name</th> <th>to_station_id</th> <th>to_station_name</th> <th>usertype</th> <th>gender</th> <th>birthyear</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>16734065</td> <td>9/30/2017 23:59:58</td> <td>10/1/2017 00:05:47</td> <td>1411  </td> <td>349         </td> <td>216            </td> <td>California Ave & Division St</td> <td>259          </td> <td>California Ave & Francis Pl    </td> <td>Subscriber</td> <td>Male  </td> <td>1985     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>16734064</td> <td>9/30/2017 23:59:53</td> <td>10/1/2017 00:05:47</td> <td>3048  </td> <td>354         </td> <td>216            </td> <td>California Ave & Division St</td> <td>259          </td> <td>California Ave & Francis Pl    </td> <td>Subscriber</td> <td>Male  </td> <td>1979     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>16734063</td> <td>9/30/2017 23:59:06</td> <td>10/1/2017 00:02:52</td> <td>2590  </td> <td>226         </td> <td>141            </td> <td>Clark St & Lincoln Ave      </td> <td>144          </td> <td>Larrabee St & Webster Ave      </td> <td>Subscriber</td> <td>Male  </td> <td>1993     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>16734062</td> <td>9/30/2017 23:58:56</td> <td>10/1/2017 00:07:37</td> <td>551   </td> <td>521         </td> <td>96             </td> <td>Desplaines St & Randolph St </td> <td>217          </td> <td>Racine Ave (May St) & Fulton St</td> <td>Customer  </td> <td>nan   </td> <td>nan      </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>16734061</td> <td>9/30/2017 23:58:47</td> <td>10/1/2017 00:07:37</td> <td>1287  </td> <td>530         </td> <td>96             </td> <td>Desplaines St & Randolph St </td> <td>217          </td> <td>Racine Ave (May St) & Fulton St</td> <td>Subscriber</td> <td>Female</td> <td>1994     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>16734060</td> <td>9/30/2017 23:58:45</td> <td>10/1/2017 00:16:37</td> <td>6132  </td> <td>1072        </td> <td>478            </td> <td>Rockwell St & Eastwood Ave  </td> <td>117          </td> <td>Wilton Ave & Belmont Ave       </td> <td>Subscriber</td> <td>Male  </td> <td>1980     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>16734059</td> <td>9/30/2017 23:57:19</td> <td>10/1/2017 00:05:36</td> <td>5235  </td> <td>497         </td> <td>114            </td> <td>Sheffield Ave & Waveland Ave</td> <td>296          </td> <td>Broadway & Belmont Ave         </td> <td>Subscriber</td> <td>Male  </td> <td>1988     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>16734058</td> <td>9/30/2017 23:57:12</td> <td>10/1/2017 00:00:46</td> <td>54    </td> <td>214         </td> <td>87             </td> <td>Racine Ave & Fullerton Ave  </td> <td>127          </td> <td>Lincoln Ave & Fullerton Ave    </td> <td>Subscriber</td> <td>Male  </td> <td>1977     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>16734057</td> <td>9/30/2017 23:56:59</td> <td>10/1/2017 00:20:17</td> <td>3823  </td> <td>1398        </td> <td>90             </td> <td>Millennium Park             </td> <td>86           </td> <td>Eckhart Park                   </td> <td>Customer  </td> <td>nan   </td> <td>nan      </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>16734056</td> <td>9/30/2017 23:56:52</td> <td>10/1/2017 00:14:44</td> <td>5794  </td> <td>1072        </td> <td>296            </td> <td>Broadway & Belmont Ave      </td> <td>268          </td> <td>Lake Shore Dr & North Blvd     </td> <td>Subscriber</td> <td>Female</td> <td>1990     </td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>\n",
       "<p>... (1608260 rows omitted)</p>"
      ],
      "text/plain": [
       "trip_id  | start_time         | end_time           | bikeid | tripduration | from_station_id | from_station_name            | to_station_id | to_station_name                 | usertype   | gender | birthyear\n",
       "16734065 | 9/30/2017 23:59:58 | 10/1/2017 00:05:47 | 1411   | 349          | 216             | California Ave & Division St | 259           | California Ave & Francis Pl     | Subscriber | Male   | 1985\n",
       "16734064 | 9/30/2017 23:59:53 | 10/1/2017 00:05:47 | 3048   | 354          | 216             | California Ave & Division St | 259           | California Ave & Francis Pl     | Subscriber | Male   | 1979\n",
       "16734063 | 9/30/2017 23:59:06 | 10/1/2017 00:02:52 | 2590   | 226          | 141             | Clark St & Lincoln Ave       | 144           | Larrabee St & Webster Ave       | Subscriber | Male   | 1993\n",
       "16734062 | 9/30/2017 23:58:56 | 10/1/2017 00:07:37 | 551    | 521          | 96              | Desplaines St & Randolph St  | 217           | Racine Ave (May St) & Fulton St | Customer   | nan    | nan\n",
       "16734061 | 9/30/2017 23:58:47 | 10/1/2017 00:07:37 | 1287   | 530          | 96              | Desplaines St & Randolph St  | 217           | Racine Ave (May St) & Fulton St | Subscriber | Female | 1994\n",
       "16734060 | 9/30/2017 23:58:45 | 10/1/2017 00:16:37 | 6132   | 1072         | 478             | Rockwell St & Eastwood Ave   | 117           | Wilton Ave & Belmont Ave        | Subscriber | Male   | 1980\n",
       "16734059 | 9/30/2017 23:57:19 | 10/1/2017 00:05:36 | 5235   | 497          | 114             | Sheffield Ave & Waveland Ave | 296           | Broadway & Belmont Ave          | Subscriber | Male   | 1988\n",
       "16734058 | 9/30/2017 23:57:12 | 10/1/2017 00:00:46 | 54     | 214          | 87              | Racine Ave & Fullerton Ave   | 127           | Lincoln Ave & Fullerton Ave     | Subscriber | Male   | 1977\n",
       "16734057 | 9/30/2017 23:56:59 | 10/1/2017 00:20:17 | 3823   | 1398         | 90              | Millennium Park              | 86            | Eckhart Park                    | Customer   | nan    | nan\n",
       "16734056 | 9/30/2017 23:56:52 | 10/1/2017 00:14:44 | 5794   | 1072         | 296             | Broadway & Belmont Ave       | 268           | Lake Shore Dr & North Blvd      | Subscriber | Female | 1990\n",
       "... (1608260 rows omitted)"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "trips_Q3 = Table.read_table('Divvy_Trips_2017_Q3.csv')\n",
    "trips_Q3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "a40c5f6e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>trip_id</th> <th>start_time</th> <th>end_time</th> <th>bikeid</th> <th>tripduration</th> <th>from_station_id</th> <th>from_station_name</th> <th>to_station_id</th> <th>to_station_name</th> <th>usertype</th> <th>gender</th> <th>birthyear</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>17536701</td> <td>12/31/2017 23:58</td> <td>1/1/2018 0:03   </td> <td>3304  </td> <td>284         </td> <td>159            </td> <td>Claremont Ave & Hirsch St          </td> <td>69           </td> <td>Damen Ave & Pierce Ave             </td> <td>Subscriber</td> <td>Male  </td> <td>1988     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>17536700</td> <td>12/31/2017 23:54</td> <td>1/1/2018 0:18   </td> <td>5975  </td> <td>1402        </td> <td>145            </td> <td>Mies van der Rohe Way & Chestnut St</td> <td>145          </td> <td>Mies van der Rohe Way & Chestnut St</td> <td>Customer  </td> <td>nan   </td> <td>nan      </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>17536699</td> <td>12/31/2017 23:54</td> <td>1/1/2018 0:18   </td> <td>4906  </td> <td>1441        </td> <td>145            </td> <td>Mies van der Rohe Way & Chestnut St</td> <td>145          </td> <td>Mies van der Rohe Way & Chestnut St</td> <td>Customer  </td> <td>nan   </td> <td>nan      </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>17536698</td> <td>12/31/2017 23:48</td> <td>12/31/2017 23:53</td> <td>5667  </td> <td>315         </td> <td>340            </td> <td>Clark St & Wrightwood Ave          </td> <td>143          </td> <td>Sedgwick St & Webster Ave          </td> <td>Subscriber</td> <td>Male  </td> <td>1963     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>17536697</td> <td>12/31/2017 23:42</td> <td>12/31/2017 23:47</td> <td>5353  </td> <td>272         </td> <td>240            </td> <td>Sheridan Rd & Irving Park Rd       </td> <td>245          </td> <td>Clarendon Ave & Junior Ter         </td> <td>Subscriber</td> <td>Male  </td> <td>1977     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>17536696</td> <td>12/31/2017 23:41</td> <td>12/31/2017 23:51</td> <td>5840  </td> <td>589         </td> <td>93             </td> <td>Sheffield Ave & Willow St          </td> <td>343          </td> <td>Racine Ave & Wrightwood Ave        </td> <td>Subscriber</td> <td>Male  </td> <td>1988     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>17536695</td> <td>12/31/2017 23:34</td> <td>12/31/2017 23:39</td> <td>6351  </td> <td>301         </td> <td>337            </td> <td>Clark St & Chicago Ave             </td> <td>182          </td> <td>Wells St & Elm St                  </td> <td>Subscriber</td> <td>Male  </td> <td>1990     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>17536694</td> <td>12/31/2017 23:21</td> <td>12/31/2017 23:23</td> <td>2562  </td> <td>141         </td> <td>226            </td> <td>Racine Ave & Belmont Ave           </td> <td>117          </td> <td>Wilton Ave & Belmont Ave           </td> <td>Subscriber</td> <td>Male  </td> <td>1987     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>17536693</td> <td>12/31/2017 23:17</td> <td>12/31/2017 23:27</td> <td>2471  </td> <td>615         </td> <td>49             </td> <td>Dearborn St & Monroe St            </td> <td>26           </td> <td>McClurg Ct & Illinois St           </td> <td>Subscriber</td> <td>Male  </td> <td>1981     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>17536692</td> <td>12/31/2017 22:57</td> <td>12/31/2017 23:09</td> <td>6462  </td> <td>743         </td> <td>196            </td> <td>Cityfront Plaza Dr & Pioneer Ct    </td> <td>255          </td> <td>Indiana Ave & Roosevelt Rd         </td> <td>Subscriber</td> <td>Male  </td> <td>1980     </td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>\n",
       "<p>... (669229 rows omitted)</p>"
      ],
      "text/plain": [
       "trip_id  | start_time       | end_time         | bikeid | tripduration | from_station_id | from_station_name                   | to_station_id | to_station_name                     | usertype   | gender | birthyear\n",
       "17536701 | 12/31/2017 23:58 | 1/1/2018 0:03    | 3304   | 284          | 159             | Claremont Ave & Hirsch St           | 69            | Damen Ave & Pierce Ave              | Subscriber | Male   | 1988\n",
       "17536700 | 12/31/2017 23:54 | 1/1/2018 0:18    | 5975   | 1402         | 145             | Mies van der Rohe Way & Chestnut St | 145           | Mies van der Rohe Way & Chestnut St | Customer   | nan    | nan\n",
       "17536699 | 12/31/2017 23:54 | 1/1/2018 0:18    | 4906   | 1441         | 145             | Mies van der Rohe Way & Chestnut St | 145           | Mies van der Rohe Way & Chestnut St | Customer   | nan    | nan\n",
       "17536698 | 12/31/2017 23:48 | 12/31/2017 23:53 | 5667   | 315          | 340             | Clark St & Wrightwood Ave           | 143           | Sedgwick St & Webster Ave           | Subscriber | Male   | 1963\n",
       "17536697 | 12/31/2017 23:42 | 12/31/2017 23:47 | 5353   | 272          | 240             | Sheridan Rd & Irving Park Rd        | 245           | Clarendon Ave & Junior Ter          | Subscriber | Male   | 1977\n",
       "17536696 | 12/31/2017 23:41 | 12/31/2017 23:51 | 5840   | 589          | 93              | Sheffield Ave & Willow St           | 343           | Racine Ave & Wrightwood Ave         | Subscriber | Male   | 1988\n",
       "17536695 | 12/31/2017 23:34 | 12/31/2017 23:39 | 6351   | 301          | 337             | Clark St & Chicago Ave              | 182           | Wells St & Elm St                   | Subscriber | Male   | 1990\n",
       "17536694 | 12/31/2017 23:21 | 12/31/2017 23:23 | 2562   | 141          | 226             | Racine Ave & Belmont Ave            | 117           | Wilton Ave & Belmont Ave            | Subscriber | Male   | 1987\n",
       "17536693 | 12/31/2017 23:17 | 12/31/2017 23:27 | 2471   | 615          | 49              | Dearborn St & Monroe St             | 26            | McClurg Ct & Illinois St            | Subscriber | Male   | 1981\n",
       "17536692 | 12/31/2017 22:57 | 12/31/2017 23:09 | 6462   | 743          | 196             | Cityfront Plaza Dr & Pioneer Ct     | 255           | Indiana Ave & Roosevelt Rd          | Subscriber | Male   | 1980\n",
       "... (669229 rows omitted)"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "trips_Q4 = Table.read_table('Divvy_Trips_2017_Q4.csv')\n",
    "trips_Q4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "80ad5282",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>start_time</th> <th>end_time</th> <th>bikeid</th> <th>tripduration</th> <th>from_station_id</th> <th>to_station_id</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:59:58</td> <td>10/1/2017 00:05:47</td> <td>1411  </td> <td>349         </td> <td>216            </td> <td>259          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:59:53</td> <td>10/1/2017 00:05:47</td> <td>3048  </td> <td>354         </td> <td>216            </td> <td>259          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:59:06</td> <td>10/1/2017 00:02:52</td> <td>2590  </td> <td>226         </td> <td>141            </td> <td>144          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:58:56</td> <td>10/1/2017 00:07:37</td> <td>551   </td> <td>521         </td> <td>96             </td> <td>217          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:58:47</td> <td>10/1/2017 00:07:37</td> <td>1287  </td> <td>530         </td> <td>96             </td> <td>217          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:58:45</td> <td>10/1/2017 00:16:37</td> <td>6132  </td> <td>1072        </td> <td>478            </td> <td>117          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:57:19</td> <td>10/1/2017 00:05:36</td> <td>5235  </td> <td>497         </td> <td>114            </td> <td>296          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:57:12</td> <td>10/1/2017 00:00:46</td> <td>54    </td> <td>214         </td> <td>87             </td> <td>127          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:56:59</td> <td>10/1/2017 00:20:17</td> <td>3823  </td> <td>1398        </td> <td>90             </td> <td>86           </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:56:52</td> <td>10/1/2017 00:14:44</td> <td>5794  </td> <td>1072        </td> <td>296            </td> <td>268          </td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>\n",
       "<p>... (2277499 rows omitted)</p>"
      ],
      "text/plain": [
       "start_time         | end_time           | bikeid | tripduration | from_station_id | to_station_id\n",
       "9/30/2017 23:59:58 | 10/1/2017 00:05:47 | 1411   | 349          | 216             | 259\n",
       "9/30/2017 23:59:53 | 10/1/2017 00:05:47 | 3048   | 354          | 216             | 259\n",
       "9/30/2017 23:59:06 | 10/1/2017 00:02:52 | 2590   | 226          | 141             | 144\n",
       "9/30/2017 23:58:56 | 10/1/2017 00:07:37 | 551    | 521          | 96              | 217\n",
       "9/30/2017 23:58:47 | 10/1/2017 00:07:37 | 1287   | 530          | 96              | 217\n",
       "9/30/2017 23:58:45 | 10/1/2017 00:16:37 | 6132   | 1072         | 478             | 117\n",
       "9/30/2017 23:57:19 | 10/1/2017 00:05:36 | 5235   | 497          | 114             | 296\n",
       "9/30/2017 23:57:12 | 10/1/2017 00:00:46 | 54     | 214          | 87              | 127\n",
       "9/30/2017 23:56:59 | 10/1/2017 00:20:17 | 3823   | 1398         | 90              | 86\n",
       "9/30/2017 23:56:52 | 10/1/2017 00:14:44 | 5794   | 1072         | 296             | 268\n",
       "... (2277499 rows omitted)"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# combining the two datasets trips_Q3 and trips_Q4, selecting only relevant columns\n",
    "trips = Table().with_columns('start_time', np.append(trips_Q3.column('start_time'), trips_Q4.column('start_time')),\n",
    "                            'end_time', np.append(trips_Q3.column('end_time'), trips_Q4.column('end_time')),\n",
    "                             'bikeid', np.append(trips_Q3.column('bikeid'), trips_Q4.column('bikeid')),\n",
    "                             'tripduration', np.append(trips_Q3.column('tripduration'), trips_Q4.column('tripduration')),\n",
    "                            'from_station_id', np.append(trips_Q3.column('from_station_id'), trips_Q4.column('from_station_id')),\n",
    "                            'to_station_id', np.append(trips_Q3.column('to_station_id'), trips_Q4.column('to_station_id')))\n",
    "trips"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "7d9c0085",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>id</th> <th>name</th> <th>city</th> <th>latitude</th> <th>longitude</th> <th>dpcapacity</th> <th>online_date</th> <th>Unnamed: 7</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>2   </td> <td>Buckingham Fountain        </td> <td>Chicago</td> <td>41.8764 </td> <td>-87.6203 </td> <td>27        </td> <td>6/10/2013 10:43</td> <td>nan       </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>3   </td> <td>Shedd Aquarium             </td> <td>Chicago</td> <td>41.8672 </td> <td>-87.6154 </td> <td>55        </td> <td>6/10/2013 10:44</td> <td>nan       </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>4   </td> <td>Burnham Harbor             </td> <td>Chicago</td> <td>41.8563 </td> <td>-87.6133 </td> <td>23        </td> <td>6/10/2013 10:46</td> <td>nan       </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>5   </td> <td>State St & Harrison St     </td> <td>Chicago</td> <td>41.8741 </td> <td>-87.6277 </td> <td>23        </td> <td>6/10/2013 10:46</td> <td>nan       </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>6   </td> <td>Dusable Harbor             </td> <td>Chicago</td> <td>41.885  </td> <td>-87.6128 </td> <td>39        </td> <td>6/10/2013 11:18</td> <td>nan       </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>7   </td> <td>Field Blvd & South Water St</td> <td>Chicago</td> <td>41.8863 </td> <td>-87.6175 </td> <td>19        </td> <td>6/19/2013 10:00</td> <td>nan       </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9   </td> <td>Leavitt St & Archer Ave    </td> <td>Chicago</td> <td>41.8288 </td> <td>-87.6806 </td> <td>19        </td> <td>6/21/2013 9:33 </td> <td>nan       </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>11  </td> <td>Jeffery Blvd & 71st St     </td> <td>Chicago</td> <td>41.7666 </td> <td>-87.5765 </td> <td>11        </td> <td>6/21/2013 9:39 </td> <td>nan       </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>12  </td> <td>South Shore Dr & 71st St   </td> <td>Chicago</td> <td>41.7664 </td> <td>-87.5657 </td> <td>15        </td> <td>6/21/2013 10:00</td> <td>nan       </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>13  </td> <td>Wilton Ave & Diversey Pkwy </td> <td>Chicago</td> <td>41.9324 </td> <td>-87.6527 </td> <td>27        </td> <td>6/22/2013 18:29</td> <td>nan       </td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>\n",
       "<p>... (575 rows omitted)</p>"
      ],
      "text/plain": [
       "id   | name                        | city    | latitude | longitude | dpcapacity | online_date     | Unnamed: 7\n",
       "2    | Buckingham Fountain         | Chicago | 41.8764  | -87.6203  | 27         | 6/10/2013 10:43 | nan\n",
       "3    | Shedd Aquarium              | Chicago | 41.8672  | -87.6154  | 55         | 6/10/2013 10:44 | nan\n",
       "4    | Burnham Harbor              | Chicago | 41.8563  | -87.6133  | 23         | 6/10/2013 10:46 | nan\n",
       "5    | State St & Harrison St      | Chicago | 41.8741  | -87.6277  | 23         | 6/10/2013 10:46 | nan\n",
       "6    | Dusable Harbor              | Chicago | 41.885   | -87.6128  | 39         | 6/10/2013 11:18 | nan\n",
       "7    | Field Blvd & South Water St | Chicago | 41.8863  | -87.6175  | 19         | 6/19/2013 10:00 | nan\n",
       "9    | Leavitt St & Archer Ave     | Chicago | 41.8288  | -87.6806  | 19         | 6/21/2013 9:33  | nan\n",
       "11   | Jeffery Blvd & 71st St      | Chicago | 41.7666  | -87.5765  | 11         | 6/21/2013 9:39  | nan\n",
       "12   | South Shore Dr & 71st St    | Chicago | 41.7664  | -87.5657  | 15         | 6/21/2013 10:00 | nan\n",
       "13   | Wilton Ave & Diversey Pkwy  | Chicago | 41.9324  | -87.6527  | 27         | 6/22/2013 18:29 | nan\n",
       "... (575 rows omitted)"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "stations = Table.read_table('Divvy_Stations_2017_Q3Q4.csv')\n",
    "stations"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ff17ef81",
   "metadata": {},
   "source": [
    "# DATA PROCESSING AND EXPLORATION"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3dbdab0c",
   "metadata": {},
   "source": [
    "## 1) Analyze the busiest origin and destination stations"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fe5c527d",
   "metadata": {},
   "source": [
    "### Busiest origin stations (from_station_id)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "59042ce7",
   "metadata": {},
   "source": [
    "We decided to graph the top 10 busiest origin stations based on the number of trips that start at each bike station. The results, as shown in the graph, indicate that station 35 receives the most traffic by a significant proportion. This is important because managing bike relocation requires an understanding of which stations have the most bikes removed."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "6a543537",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/minhanhtrinh/opt/anaconda3/lib/python3.9/site-packages/datascience/tables.py:3647: UserWarning: FixedFormatter should only be used together with FixedLocator\n",
      "  axis.set_xticklabels(tick_labels, stretch='ultra-condensed')\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>id</th> <th>count</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>35  </td> <td>60885</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>192 </td> <td>32806</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>76  </td> <td>31578</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>177 </td> <td>30603</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>268 </td> <td>30045</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>91  </td> <td>27403</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>77  </td> <td>25410</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>85  </td> <td>24546</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>195 </td> <td>22691</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>287 </td> <td>21773</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "id   | count\n",
       "35   | 60885\n",
       "192  | 32806\n",
       "76   | 31578\n",
       "177  | 30603\n",
       "268  | 30045\n",
       "91   | 27403\n",
       "77   | 25410\n",
       "85   | 24546\n",
       "195  | 22691\n",
       "287  | 21773"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# origin_station_c returns the number of times a bike was taken out from a station\n",
    "origin_station_id, origin_station_c = np.unique(trips.column('from_station_id'), \n",
    "                                                          return_counts=True)\n",
    "busiest_origin_stations = Table().with_columns('id', origin_station_id,\n",
    "                                            'count', origin_station_c)\n",
    "busiest_origin_stations = busiest_origin_stations.sort('count', descending=True)\n",
    "busiest_origin_stations.take(np.arange(10)).bar('id')\n",
    "busiest_origin_stations.take(np.arange(10))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f4f0c98a",
   "metadata": {},
   "source": [
    "### Busiest destination stations (to_station_id)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "00f39863",
   "metadata": {},
   "source": [
    "To illustrate which stations have the most bikes returned, we graphed the top 10 busiest destination stations based on the number of trips that end at each station.  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "e5142e06",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>id</th> <th>count</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>35  </td> <td>66486</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>192 </td> <td>35257</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>268 </td> <td>33357</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>177 </td> <td>32252</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>76  </td> <td>29457</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>77  </td> <td>29329</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>85  </td> <td>26279</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>91  </td> <td>25691</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>90  </td> <td>23860</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>43  </td> <td>22341</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "id   | count\n",
       "35   | 66486\n",
       "192  | 35257\n",
       "268  | 33357\n",
       "177  | 32252\n",
       "76   | 29457\n",
       "77   | 29329\n",
       "85   | 26279\n",
       "91   | 25691\n",
       "90   | 23860\n",
       "43   | 22341"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "dest_station_id, dest_station_c = np.unique(trips.column('to_station_id'), \n",
    "                                                          return_counts=True)\n",
    "busiest_dest_stations = Table().with_columns('id', dest_station_id,\n",
    "                                            'count', dest_station_c)\n",
    "busiest_dest_stations = busiest_dest_stations.sort('count', descending=True)\n",
    "busiest_origin_stations.take(np.arange(10)).bar('id')\n",
    "busiest_dest_stations.take(np.arange(10))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8c2c1f5e",
   "metadata": {},
   "source": [
    "#### Insight:\n",
    "The 10 busiest origin stations are 35, 192, 76, 177, 268, 91, 77, 85, 195, 287\\\n",
    "The 10 busiest destionation stations are 35, 192, 268, 177, 76, 77, 85, 91, 90, 43"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ce8624e4",
   "metadata": {},
   "source": [
    "## 2) Analyze the busiest days of the week"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ba0c6860",
   "metadata": {},
   "source": [
    "We decided to graph the percentage of traffic by day to better understand customer behavior and how the day of the week could affect bike placement schedules.  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "726a9837",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>start_time</th> <th>end_time</th> <th>bikeid</th> <th>tripduration</th> <th>from_station_id</th> <th>to_station_id</th> <th>date</th> <th>day</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:59:58</td> <td>10/1/2017 00:05:47</td> <td>1411  </td> <td>349         </td> <td>216            </td> <td>259          </td> <td>9/30/2017</td> <td>Saturday</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:59:53</td> <td>10/1/2017 00:05:47</td> <td>3048  </td> <td>354         </td> <td>216            </td> <td>259          </td> <td>9/30/2017</td> <td>Saturday</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:59:06</td> <td>10/1/2017 00:02:52</td> <td>2590  </td> <td>226         </td> <td>141            </td> <td>144          </td> <td>9/30/2017</td> <td>Saturday</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:58:56</td> <td>10/1/2017 00:07:37</td> <td>551   </td> <td>521         </td> <td>96             </td> <td>217          </td> <td>9/30/2017</td> <td>Saturday</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:58:47</td> <td>10/1/2017 00:07:37</td> <td>1287  </td> <td>530         </td> <td>96             </td> <td>217          </td> <td>9/30/2017</td> <td>Saturday</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:58:45</td> <td>10/1/2017 00:16:37</td> <td>6132  </td> <td>1072        </td> <td>478            </td> <td>117          </td> <td>9/30/2017</td> <td>Saturday</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:57:19</td> <td>10/1/2017 00:05:36</td> <td>5235  </td> <td>497         </td> <td>114            </td> <td>296          </td> <td>9/30/2017</td> <td>Saturday</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:57:12</td> <td>10/1/2017 00:00:46</td> <td>54    </td> <td>214         </td> <td>87             </td> <td>127          </td> <td>9/30/2017</td> <td>Saturday</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:56:59</td> <td>10/1/2017 00:20:17</td> <td>3823  </td> <td>1398        </td> <td>90             </td> <td>86           </td> <td>9/30/2017</td> <td>Saturday</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:56:52</td> <td>10/1/2017 00:14:44</td> <td>5794  </td> <td>1072        </td> <td>296            </td> <td>268          </td> <td>9/30/2017</td> <td>Saturday</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>\n",
       "<p>... (2277499 rows omitted)</p>"
      ],
      "text/plain": [
       "start_time         | end_time           | bikeid | tripduration | from_station_id | to_station_id | date      | day\n",
       "9/30/2017 23:59:58 | 10/1/2017 00:05:47 | 1411   | 349          | 216             | 259           | 9/30/2017 | Saturday\n",
       "9/30/2017 23:59:53 | 10/1/2017 00:05:47 | 3048   | 354          | 216             | 259           | 9/30/2017 | Saturday\n",
       "9/30/2017 23:59:06 | 10/1/2017 00:02:52 | 2590   | 226          | 141             | 144           | 9/30/2017 | Saturday\n",
       "9/30/2017 23:58:56 | 10/1/2017 00:07:37 | 551    | 521          | 96              | 217           | 9/30/2017 | Saturday\n",
       "9/30/2017 23:58:47 | 10/1/2017 00:07:37 | 1287   | 530          | 96              | 217           | 9/30/2017 | Saturday\n",
       "9/30/2017 23:58:45 | 10/1/2017 00:16:37 | 6132   | 1072         | 478             | 117           | 9/30/2017 | Saturday\n",
       "9/30/2017 23:57:19 | 10/1/2017 00:05:36 | 5235   | 497          | 114             | 296           | 9/30/2017 | Saturday\n",
       "9/30/2017 23:57:12 | 10/1/2017 00:00:46 | 54     | 214          | 87              | 127           | 9/30/2017 | Saturday\n",
       "9/30/2017 23:56:59 | 10/1/2017 00:20:17 | 3823   | 1398         | 90              | 86            | 9/30/2017 | Saturday\n",
       "9/30/2017 23:56:52 | 10/1/2017 00:14:44 | 5794   | 1072         | 296             | 268           | 9/30/2017 | Saturday\n",
       "... (2277499 rows omitted)"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "date_array = [\"\" for i in range(trips.num_rows)]\n",
    "# extracting the date portion from start_time variable\n",
    "for i in np.arange(trips.num_rows):\n",
    "    date_array[i] = trips.column('start_time')[i].split(' ')[0]\n",
    "trips = trips.with_column('date', date_array)\n",
    "trips\n",
    "# the function findWeekday takes input a date and convert it into a weekday\n",
    "def findWeekday(x):\n",
    "    date = x.split(' ')[0]\n",
    "    m,d,y = (int(i) for i in date.split('/'))   \n",
    "    dayNumber = calendar.weekday(y,m,d)\n",
    "    days =[\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\",\n",
    "                         \"Friday\", \"Saturday\", \"Sunday\"]\n",
    "    return (days[dayNumber])\n",
    "trips = trips.with_column('day', trips.apply(findWeekday, 'start_time'))\n",
    "trips"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "70039aa7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "([<matplotlib.patches.Wedge at 0x7f9263b37790>,\n",
       "  <matplotlib.patches.Wedge at 0x7f9263b37eb0>,\n",
       "  <matplotlib.patches.Wedge at 0x7f9263b47610>,\n",
       "  <matplotlib.patches.Wedge at 0x7f9263b47d30>,\n",
       "  <matplotlib.patches.Wedge at 0x7f9265e26490>,\n",
       "  <matplotlib.patches.Wedge at 0x7f9265e26bb0>,\n",
       "  <matplotlib.patches.Wedge at 0x7f9265e33310>],\n",
       " [Text(0.9894414528990799, 0.4806304310850054, 'Friday'),\n",
       "  Text(0.2045556294337497, 1.0808131172718818, 'Monday'),\n",
       "  Text(-0.7353947947586602, 0.8180430892329991, 'Saturday'),\n",
       "  Text(-1.0999885273618832, -0.005023910054478631, 'Sunday'),\n",
       "  Text(-0.7187168405866521, -0.8327341130619913, 'Thursday'),\n",
       "  Text(0.22904363457634655, -1.0758898705072268, 'Tuesday'),\n",
       "  Text(0.9928145270536883, -0.4736236004161546, 'Wednesday')],\n",
       " [Text(0.5396953379449526, 0.26216205331909387, '14.4%'),\n",
       "  Text(0.11157579787295437, 0.5895344276028446, '15.3%'),\n",
       "  Text(-0.4011244335047237, 0.4462053213998176, '14.0%'),\n",
       "  Text(-0.5999937421973908, -0.002740314575170162, '12.8%'),\n",
       "  Text(-0.3920273675927193, -0.45421860712472245, '14.4%'),\n",
       "  Text(0.12493289158709811, -0.5868490202766691, '15.0%'),\n",
       "  Text(0.541535196574739, -0.25834014568153885, '14.2%')])"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAASMAAADnCAYAAABVLjA7AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAABJWUlEQVR4nO2dd3hUVfrHP9MyyaT3ThJaKGmEEkKNoKCgiCIii7I068q6KGtFRV1c117Wn4qLYEFBQUSaIgrSgpBACC3UBEISQnpmkplMu78/IiMxpE8yk8z9PI+PzL3nnvveycx33nPOe95XIgiCgIiIiIiNkdraABEREREQxUhERMROEMVIRETELhDFSERExC4QxUhERMQuEMVIRETELhDFSERExC4QxUhERMQuEMVIRETELhDFSERExC4QxUhERMQuEMVIRETELhDFSERExC4QxUhERMQuEMVIRETELhDFSERExC4QxUjEZkgkEu655x7La6PRiL+/PzfffLNV+l+8eDGvv/66VfoSaX9EMRKxGa6urhw9ehStVgvATz/9RGhoqI2tErEVohiJ2JSbbrqJTZs2AfDVV18xffp0y7nS0lImT55MXFwcQ4cOJTMzE6j1eObMmUNKSgrdu3fn3XfftVyzZMkSoqOjuf766zl58qTl+Mcff8zgwYOJj49nypQpVFdXo1ariYqKwmAwAFBZWUlkZKTltUjHIoqRiE256667WLVqFTqdjszMTJKSkiznnn/+eQYMGEBmZiYvv/wyM2fOtJzLysrixx9/ZP/+/bzwwgsYDAbS09NZtWoVhw4d4ttvv+XAgQOW9rfffjsHDhzg8OHD9O3bl2XLluHu7k5KSopFDFetWsWUKVNQKBQd9waIWBDFSMSmxMXFkZOTw1dffcWECRPqnNu9e7dlTmnMmDGUlJRQUVEBwMSJE1Eqlfj5+REQEEBhYSG7du3itttuQ6VS4eHhwaRJkyx9HT16lJEjRxIbG8vKlSs5duwYAPPmzWP58uUALF++nNmzZ3fEY4tcA7mtDRARmTRpEgsXLmTHjh2UlJRYjl+rcI1EIgFAqVRajslkMoxGY53zf2bWrFl89913xMfHs2LFCnbs2AHA8OHDycnJ4ddff8VkMhETE2OtxxJpIaJnJGJz5syZw3PPPUdsbGyd46NGjWLlypUA7NixAz8/Pzw8PBrsZ9SoUaxbtw6tVotarWbDhg2Wc2q1muDgYAwGg6XPK8ycOZPp06eLXpGNET0jEZsTFhbGI488Uu/44sWLmT17NnFxcahUKj799NNG+0lMTGTatGkkJCQQERHByJEjLedeeuklkpKSiIiIIDY2FrVabTk3Y8YMFi1aVGfyXKTjkYhFHEUcnTVr1rB+/Xo+//xzW5vi0IiekYhDM3/+fLZs2cLmzZttbYrDI3pGIk0iCEKd/yQSSZ3/RESsgegZOSiCIGA2m6nS6SnR1FCp06MzmDGYzOhNAkaTGb2p9rXWYEZdY6RCZ6RCa0CpkOKrcsLbRYHKSYaTXIpSLkUpk6JUyFDKpDjJpTgrZPi6OaNSKpBKpaJwiTSKKEZdnCveTI3BSLFaS3m1ntJqPWXVBk4WaTicp+ZCuY4ak/UdZBeFlAgvZ+JD3Onp54q3SoGPyglfNyX+7i7I5XJRoEQsiMO0LojZbOZyRRX55dUUVOo4X6rlUH4lZ0u0qGtMtjYPX5WC+BB3BoV5EOjuTIC7knAfN1TOTqI4OTCiGHUBBEFAp9OTX1rFhYpqMgvUbDtVwiWN3tamNQuZBAaGeXBjtB+Rvq5083XDQ+UsCpODIYpRJ0UQBLTaGspKtJSX6Tl3SkNYXxfu25xla9PahAToG+jKzX396eHnSoSvG95uLkilYnxuV0ecM+pkmEwmii9rKLqs4/QJNUWX9Fz5OQmNdMZJCnqzbW1sCwJwvLCK44VVAER4OXNr/wCiA9zo5utKoJeb6DF1UUTPqBNQOwwzUHxZQ25ONVlH1BgM9f9swWFKTrvrWHWk0AZWtj/hnkpmDw4lJsSTCH9P0VvqYohiZMcIgkBFeRVFl7WcOqbm4nldo+2lUhhwvRcPdvKhWlN4Osv566AQBoV70TPIC4VcdPC7AuJf0Q4xGo0UF2m4fEnHkfQKNOrmrYCZzSB3gLxgFToj7+6+gJMsl6lxgYzu6UvvIC9USnE1rjMjekZ2hNlspuiyhpyzao4erMRobPmfpmdfV9aVXea3i+qmG3cRpBIY29OHSf0DiQ7yxMvNRRSlTogoRnaAIAiUl1eRd0FD2t5yanStn4F2UkroPtyNhVtPW9HCzkNCiBvzksKJDfdFpXSytTkiLUAcptkQQRCorq6h4KKa9H1llJca29ynvkbAUyKzgnWdk4x8DfPXnWBafCC3xATRM8hbnOjuJNjFX2nJkiX079+fuLg4EhIS+O233xpsu2LFCvLz89t8z8jISIqLi9vcT2vR643kni/j1635/Ly5yCpCdAVtpZkQd8f1CgRg1eFCHlxzlM2ZuVwu11wza6SIfWFzzyg1NZWNGzdy8OBBlEolxcXF6PUNRw6vWLGCmJgYQkJCmn0Po9GI3E5WXARB4FJBBWey1JzIVNMe35HsU9XMTAjmlV3nrd95J6KyxsQLP50lIaSQB5K7ERPmi9JJTLZvr9jcMyooKMDPz8+S09jPz4+QkBBefPFFBg8eTExMDPfddx+CILBmzRrS0tKYMWMGCQkJaLXaOh5OWloaKSkpQG2WwPvuu49x48Yxc+ZMSkpKGDduHAMGDOD++++v80s5efJkBg4cSP/+/Vm6dCkAy5YtY8GCBZY2H3/8MY8++mibnlWn03P6ZDE/rr/E8cPtI0QA6goj3d1c2qfzTkhGvoaHvj3Osj1nOXupTPSS7BSbi9G4cePIzc2ld+/ePPTQQ/z6668APPzwwxw4cMBS5G/jxo3ccccdDBo0iJUrV5KRkYGLS+NfuPT0dNavX8+XX37JCy+8wIgRIzh06BCTJk3iwoULlnaffPIJ6enppKWl8e6771JSUsJdd93F999/b6mh1ZbKEYIgUFKsJn1fIdu3FLVpgrq5mLUCznKb/3ntBrMAy9PyeWjtEbYdu0hFldbWJon8CZt/Wt3c3EhPT2fp0qX4+/szbdo0VqxYwfbt20lKSiI2NpZffvnFUlqmJUyaNMkiWDt37uTuu+8GasvceHt7W9q9++67xMfHM3ToUHJzczl9+jSurq6MGTOGjRs3kpWVhcFgqJcwvjmYTCZyz5eybfMljh7quOX2i9k6pvT377D7dRZKq408veU0H+4+x/mictFLsiPsYiJFJpORkpJCSkoKsbGxfPTRR2RmZpKWlkZ4eDiLFy9Gp7t29LFcLsdsrvU0/tzG1dW1zutrxZ7s2LGDbdu2kZqaikqlIiUlxdLPvHnzePnll+nTp0+rvCJ1pZbsMxXs312KqYMzdxTm1zCyvxcrD3fNrSFtZU1mIRl5lTw5pjux3fzFFTc7wOZ/gZMnT3L69B8xMRkZGURHRwO180cajYY1a9ZYzru7u9ep7BAZGUl6ejoAa9eubfA+V5e92bJlC2VlZQBUVFTg7e2NSqUiKyuLffv2Wa5JSkoiNzeXL7/8skWVIwRBoCC/nN3bL5H6a8cLUa0NIDOIgX+NcaZEy8PrTrAzKw+dutLW5jg8NveMNBoN8+fPp7y8HLlcTs+ePVm6dCleXl7ExsYSGRnJ4MGDLe1nzZrFAw88gIuLC6mpqTz//PPMnTuXl19+uU5p5D/z/PPPM336dBITExk9ejTdunUD4MYbb+TDDz8kLi6O6Ohohg4dWue6O++8k4yMjDrDusYwmUyczy5j17ZidFrbbp8vLtAzrJsney9U2NQOe0YuleBh1FK5dj3mm6agCgy2tUkOixiB3QQ333wzCxYsYOzYsU22rakxcO5UKbt/KcFsB2k8nJwk9BzhxqMOGo3dFBLglRsi6PXW36G4EPmgEbjNehi3yB7idhIbYPNhmr1SXl5O7969cXFxaZYQadQ6jmYUsXObfQgRgF4v4O7A0dhN8WBSCD03fATFtfNqxrTdVPxrIRXHMy3zkCIdh+gZWYHysioy00s4cURja1PqETvQnTeyLnChosbWptgV1/Xw5j7ZOZRL/13/pMoNt6dfwzN+oDix3YGI73QbKSnRsH93kV0KEUDO6WrujhfnQa4mzMOJv3aTXFuIAKo1aF5eSMXhNNFD6kBEMWolgiBQdLmS1B2XyT5TbWtzGkRdaSLK1dnWZtgNznIpTw8LwmPJQ403rK5Cs2QhFRkHREHqIEQxagWCIFBUWMmuny+Td6Hx7Iv2gEkr4CJGYwPw5KgwQv7vaWhk/6MFbXWtIB38TRSkDkD8hLaCkmINe3cUU3Spc5QCyj2nY2pMgK3NsDkzBwTSf+8azBfONf8inRbNvx8XBakDEMWohZSXVZG+r5jCgs4zIXy5oIZhwZ62NsOmDAp150bykP2wpunGf0anRfPyP6lITxUFqR0RxagFaDQ6jhwsJedM59pkKQggMzpu3IyPSs6D/VQ4v/V06zup0aH59xNUpImC1F6IYtRMdDo9WUdLOJ7ZOXNLF+XrGRnheN6RXCrhuVGheP97fts7q9GhefUpKk9kihts2wFRjJqBwWDkzMlS0lM777aK3Gwtt/dxvHmjx4aHEv7pK6Cx0t4zbTWat19Ec74F804izUIUoyYwm83knC1j7/ZSW5vSJgx6ATccKxr7tn5+DDy5A8mJQ1btV8i/gOaLD9EWiRkRrInNN8raM4IgcCGnjF9/Km63rIwdSXW5iQhvZ86XNS8cIfvr16g4sQ+5mxcxjy0DIG/rpxTv34Tc1QuA0Bvn4tW37gZls0FP1of/QDAaEMwmvGNHETpuFgAXNy+lIms/qpCeRN31JAAl6T9h1FYSOGKKdR4U6OOv4nYvDfL/W2q1Pq/GmLodTY9oZLf+BSeVql3u4WiInlEjXC6sZOdPRZhaUb/MHsk+Vc09cUHNbu83aDy95taPUg4ceQf9Fyyl/4Kl9YQIQCJXEH3fG/Rf8DH9/rGUypMH0Jw/jlGrQZNzjP6P/g/BbKa64BxmQw3F6T/in3xrm57tatyVMh5N9Mb1lX9Yrc9rofviQzQH9ogT2lZCFKMG0Gh0ZKaXoa3uOh80jdpEhKr50dju3eOQqzxafB+JRIJMWZthUzAZEUxGkEiQSKS1rwUBs7EGiUzOpR2rCRh+G1KZdZx0qQSeHRWG3+sL6Igdy1XvvEDlsQxxQtsKiGJ0DcxmM+fPlnPulP1u82gtxmoBlVPb/uyX937HsTfnkf31axirr726KJhNHHvrPg6/OAWP3gNx69YXmbMKr9iRHH/7fpTeQcicXam6eBLv/sPbZM/VPJQUQo/1H0DJZav12Sg1OjRvvYAm52zH3K8LI+7a/xOCIJCXW8aP6wtbVV7a3gkIUlAQYGT5wYJmta8pvcTp5c9Y5owM6lLkrp6AhLytyzFUlhJ15z8bvN6o1XD20+foNnk+LkFRdc7lfPM6AcNuperiKSpPp+MS3J2QsXe3+tnG9vDmXskZnP73n1b30VrkQ0bh9fBTuPiKecdbi+gZ/Ynysir27y7tkkIEUFRoICmo9fFGCncfJFIZEqkU/yETqcrNarS93MUN9x4JVJw8UOd4dV5twjelfxglB3+ix93Pob2Uja7oYqvsCvdUMjNcsIkQARj376T6kLhlpC2IYnQVer2R01kVFBV2jj1nraE2N3brr9dXllj+XXZ0Ny5BkfXaGDTlGLW1KVXMhhoqT6fj7B9ep03ej8sJGTcLwWRC+P0LLJFIMRtavs3GWS7lqeRA3F9+uMXXWpPqpW+gOXvKpjZ0ZsSl/d8RBIGLF8rJ2N95Axuby+WLNVzX3Yvt58obbXdu5b9QnzuMsaqCw0umEXLDX1GfO4w2v3Z+xMk7iIgptYUu9RXF5Kx5g95z/41BXUL26lfBbEIQBHziRuPVL9nSb9nR3biG98HJ0w8At4h+HHtzHi5B3VGF9Gjx8zw9Kozg955AaM5O/PakSo1249c43/sPnNxaPvHv6IhzRr9zubCSH9cXUF1lg1IeHYxCISF6lBv/+LHz58aelRjEzUe/Q7r1W1ubYsF10Zt4Dx0p5tFuIeIwDTAajWSfqXQIIQIwGARcu0A09pBwD8aZc+1KiACqP/wPVRdyWnydTCYjISHB8l9OTv0+JkyYQHl5eb3jixcv5vXXX2+5sXaEOEwDLhWoyUx3rLpZmjITPXydOVti/8nhroW/SsED0S44L3rG1qbUQygupHrHFpynzUHu3Py4LhcXFzIyMq7dpyAgCAKbN2+2kpX2h8N7RjqdnpNHKzE7hlNkIedUNXfHds7c2AqphEWjQvB6+W+2NqVBar5ZgTrrSJuCIXNycujbty8PPfQQiYmJ5ObmEhkZSXFxMQBLliwhOjqa66+/npMnT1qu+/jjjxk8eDDx8fFMmTKF6upq1Go1UVFRGAy1qxeVlZVERkZaXtsDDi1GgiBwKV/NmayqDrnfZ6sW8c/nRvLiq/W3PmzdvpwHHu2PRlN2zWuPndjF8/+eyLNLbuSHnz+2HP92wxu89NptLP/yKcuxfWnf8/POzxu1pUpjIsxF2consS0LR4QRvuJfUG2fRRAAEMxUL3sbbeGlZl+i1WotQ7TbbrsNqK24PHPmTA4dOkRERISlbXp6OqtWreLQoUN8++23HDjwR+jE7bffzoEDBzh8+DB9+/Zl2bJluLu7k5KSwqZNmwBYtWoVU6ZMQaFQWOmB245Di5FarSXjwLW//O1B8uDJzL/vo3rHS8sKyDq1Fx/va3sqZrOJr75dwsP3fcjzT3zPgYObyb90Bq1WzbmcDJ795zrMZhN5+afQ63WkHviOlOF3NWmPsVrArY3R2B3N7TH+DDi+DbKO2NqUJjGfO4n2+KFme0dXhmkZGRmsW7cOgIiIiHpVjgF27drFbbfdhkqlwsPDg0mTJlnOHT16lJEjRxIbG8vKlSs5duwYAPPmzWP58uUALF++nNmzZ7f1Ea1K5/okWhFBELiUp6Ewv+OWg3v1GIRKVT/g8Jv1/+H2mx+jtsZpfXIuHCHALxx/33DkcicGD5hA5tHtSCRSjCYDgiBgMNQgk8n5afsnXDfybmSypn/xLpypZnpsYFsfq8PoF+DK7W4VyNcss7UpzUb7+QdUF+S1+npXV9cGzzW0Wjdr1iz++9//cuTIEZ5//nl0utp5weHDh5OTk8Ovv/6KyWQiJiam1Xa1Bw4rRqWlVaTt7TivqCEOH/0FL89AwkL7NNimrKIQb68/vCYvr0DKKgpxdnZlQNwNLHljCn4+obi4uJOTe5SEmDHNunfxZQODAjtH9kd3pYwFA7xQvfqorU1pEcLlAnTtsJF21KhRrFu3Dq1Wi1qtZsOGDZZzarWa4OBgDAYDK1eurHPdzJkzmT59ut15ReCgq2lms5m88xrUlbadtdbrtWzZtpRH7v+48YbX+Bxf+VUcP2Yu48fMBeDz1c9xy43z2b1vDcdP7iUspDcTbnig4W4FkHaCYHOpBJ4bFYbva3/rkJ341kb7xQdU943DNayb1fpMTExk2rRpJCQkEBERwciRIy3nXnrpJZKSkoiIiCA2Nha1+o/NzDNmzGDRokVMnz7darZYC4cUo5JiDQd/K7e1GRQV51JSmsdLr98OQHlFIUvevIMn/7EKT48/Nlx6ewVSVv7Hxtby8kK8POqmkL1w8QQAgf4RfP3dv1n48Gf877OFFBadJ9A/goYovFjD9T282XbW9l5iQzw8NITu696H0mJbm9IqhOJCdFmZqELDGw2E1GjqTshHRkZy9OjROseujj165plneOaZ+qENDz74IA8++OA177F7927uuOMOvLy8mv8AHYTDiVFtAUYtNTrb/8KGhvTmtRd3WV4//dINPL3ga9zcvOu0iwiP4XLRBYpLLuLlGcCBQ5uZe89rddps+OE9ZkxdjMlsxPx7nIJEIsGgb7ySycXzOm4Z7W+3YjSulw/DLmUgSdtpa1PahHb1MrSxA1EF2i6cYv78+WzZssVuY5UcTowqK6rJTLfN/rP/fb6QU2cOoKkq58kXxnDL+L8xfOi1U62WV1zm89XPMf++D5HJ5Ey7/RneXXofZrOZYUNuIySop6VtxpGfiQiPwcuz1lvqHpnAi69OJjSkd6NzUQBGg4DKbJ9Th928nJkRYsLphc4dWQwg5OeiO3MCl4Agm20Tee+992xy3+biUHvTBEHg7Olift5UZGtT7Ir+A9x4/1weZ0rspx6cs1zKW9eHErjoHjAabW2OVZD1icVn0es4e/va2hS7xD5/EtsJrVaLTl/EgKEuyB3OJ2yY7NNa7omzr2jsZ0aHEfTuE11GiABMWUfQnj3ZdEMHxaHE6NKlS6xc+Tl7f1tPv0Fqkq9zwttXVKVqjYkQZydbm2FhzsAg+m3/EiH/gq1NsTr6A3swdiGBtSYOI0Zms5mcnJzaYMdLl1i/fh3ffvcF7v7nSB4roVf/zrk1wloYqgQ87CAae2i4BzcYziP55Xtbm9Iu6H/ZiC6v64msNbD9p6+DKCoqYu/evXWO6XQ6fv11B19++SkX8ncxaFQNg0c6o3R2mLfFwoUz1UyPb34Zo/YgwFXBfdHOKN991qZ2tCvVVehzc8RqItfAYcYohYWF9eI4riYrK4usrCy8vb1JTh6Gt1cgZ09IKMy3n13N7UnxZQODE7yAfJvcXyGVsGhkCF4v2F9ksLXR79mGcfBwFErH9sb/jEO4ACaTiTNnzjSrbVlZGZs3b+Lrbz4H5TGGjhGISXRB4gDvlKTGdh+If44MI+yTF0Hb9cpD/RlD6g60uTm2NsPucICvGBQXF3PkSMt2eRsMBvbt28dXX31O5vEfSUiuJilFiat7133LCi/WcENPnw6/752x/gw4shVOHevwe9sEgx5j7jlxqPYnuu436ypKSkrQalsfQ3P+fA7ffruGjZu+Ijgqn2FjZXTrbj+rT9Yi77yOiT39OvSe/QNdmaQqR/bt8ma1X5iZw4Bth7l+Z33h+ujcJbptTqdU3/BqlUkQuGn3cWYd+MNTfjnrIuN2Hecfh7Mtx9bmlbAsu7AFT9IydD9vwlDdMXm0OgtdXozMZjN5ea1P4XA1Go2Gn37aylerPqVCm8aQFGOXilkyGgVcOjAa20MpY0GCJ6r/LGj2NVPDfPlscK96x/O1enYVqwltIkThk+zL9HT9IxVspcFEelkVW0f2wyxAVqUWncnMNxdLmBkR0EhPbcOUsV8cqv2JLi9GFRUVHDx40Kp9ms1mMjIyWL36y99jlipJHtM1YpYqS4z08Ve1+32kEnhudBg+rz7SouuSfNzxUtQvJvDCiVye7hNKYzstCrR6fi6q4K7wP7w/qQQMZjOCIKAzmZFLJXx47hJzIgNQSNtx24ZgxphzRhyqXUWXF6Pi4mLKytpvE2htzNJ3fLvuqpilfs1Pwm5vnD9TzYy49l/i/3tyKFFr3oWykqYbN8HWwnKCnJ3o59G4iC7+XbCkVymWm1zGTUHe3LT7BOEqJ9zlMg5XVDMu0KvNdjWFfu92jPqWF63sqnT+n/JGEASBy5cvd8i9rsQsSSQSoqOjGTQqHonZk8w0vV1kCGgu1VVmgpzadz5sfC8fkvPTkRzc0+a+tCYz/z1TwBdDejfablthOX5OCuI8XUktUdc592CPIB7sUSvAj2fm8FivEL7KLWZnUSV9PVz4e8/22SpjPJGBvqgQRVjDKV4ciS7tGWm12gZLv7QXgiCQlZXFN9+sZtv2NXTvX8ywsQoCQ+wn8XlT6DUCXs7t8zsV6e3MX4KNKFa8aZX+zlfVkKvVc+Pu4wzbfoQCnZ4Ju49zuaZufFhaWRU/XS5n2PYjPHzoHHtLKnkkI7tOm6MVtWEF3V2VrL1YwgeJ3Tmp1pJd1U7lnKqrMBR3zI9lZ6BLe0ZlZWVWm7xuDaWlpWzevBGFQsHAgYMYel1PNBUqjmVoEezYWTp/ppq/xAXyf/ut+965KKQ8keSP+6J7rNZnHw8XDl0fb3k9bPsRNg7vi49T3Y/2k31CebJPKACpJWo+OlfIOwlRddq8fiqfV2K7YRAETL+n15RS6321F6biywiCIFafpYt7Rmq1GrMdpCmtjVlK5atVV2KWtAy145il0iID8X7uVu930agwAt95vE078R8+dI7JqVmcq9Ix5JdMVuU2nP3xkk7PXw80r4T3j5fKifdSEeTshKdCzkAvN27YeQyJRNLkXFRbMB4/bBefUXugy+YzEgSBtLQ01q5da2tTrombmxvJycMI8A/lYraMC+fsKxn1kNFePPBzFtb6mswbFMRNaV8j2bHRSj12DST+Qfi+9gku/u0XRtBZsM+fZisgCAL5+bbZZ9Uc6sYspf8es+RsNzFLly7UcGO0dZKADYvwZKzunChE10AouoS+RJw3gi4sRlVVVZw7d87WZjRJbczSIVav/pLU/Rtq8yzZQcxSXq6Om6LaLkYBrgru7alA+d/FbTeqi2Iuar9I786EnfwOW5/KykqKijpXetmCggLWr1+Hs7MzSUlD6ZMQQXGBktPH22k1pxFMRgHnNkZjK2QSnh0ZgqcD7MRvC8YL5zCbr0Mq7bK+QbPosk9vL5PXreFKzNJXX33GhYKdDBqlZ/CIjs+zVFlspG9A6ydvnxgZRtj/FjvETvy2oE/fg1HX8T849kaXFCNBEOoUruus/BGztIpt29fQI6ZjY5ZyzlRzd2zrAv6mxfkTd2gLwpkTVraq6yEUXcJYaZuKNfZElxymCYLQ6YZoTVFaWsqmTXVjltTlLhw/rGu3mCVttZkARcuFLzbIlUnOpcjXf9YOVnU9hLJSTFpxB3+XFCOz2UxxceesPtoUV2KW9u1LJSIikoHJg3FSeHE03UCV2vqqpNcI+LjIKdU2LzbIy1nOI/GeuDz1N6vb0mURzJjFdCJdU4z0en27bo61F86fz+H8+Rzc3NwYNmw4/n4hVo9ZurJx9r3fLjbZViqBZ0eF4vPKtUsrizSMWfSMuqYYabXaRvNddzU0Gg1bt/6IVColPj6eISn9MGhdyUzXYWpjVZzSYgODE72a1faRYaFEff0WVJS27aYOiFDlOJ/XhuiSYqTX66mudrwVHLPZzKFDhzh06BDBwcEMGTIUVxdfsjLNlJW0XpUkNSCXgrGRUeCEaB+G5u6HjH2tvo8jI1RXOfwetS65mqbX6zGZTLY2w6ZciVmqrQ2XTfIYCb36tq4aRcF5HRN6NxwAGeXjzF0BehSfvdNacx0eU9Elh0+01iU9o5oaMWHVFWpjlrYjkUjo06fP73mWPFqUZyk/V8f4Mb58n1U/EZpKIeWJIf64PW29nfiOiCk3G7PZ7NCBj11SjPR6+9p0ag8IgsCJEyc4ceIEPj4+JCcPw8szkDPH4XJB47XhTCZwMtX/kkiARaPDCHjrMTCLJZvbgjk/F5NWi9zd+tkSOgtdUoZFz6hxrsQsff3NZ0hdjjN0jED/Ac6N1oarKDIQG+ha59i9g4OJ/ulTKLRdzqiugqAud/hYo2Z5RkuWLOHLL79EJpMhlUr56KOPSEpKatONFy9ejJubGwsXLmxTP9fC2IZ8Oddi8+bNnD17FpVKxdy5cwHYvn07Z86cQSaT4eXlxYQJE3B2rp/7+sCBAxw+fBiJRIK/vz8TJkxALpezY8cOzp07R0BAADfffDMAR48eRafTMWjQIKva3xAGg4HU1FRSU1OJiooiMXkQTgovjqQZqNLUHcLlnNHyl6Qgnio8C8DISE+uqzqN5NctHWJrl8dkgk66fclaNClGqampbNy4kYMHD6JUKikuLrb7YZC1JwJjY2NJTExk06ZNlmORkZGMHj0aqVTKjh072LdvHykpKXWuU6vVpKenM3fuXBQKBd999x0nTpygd+/e5OXlMWfOHDZs2EBRURFeXl4cPXqUqVOnWtX25pKdnU12djbu7u4kJw+rF7Ok05rxk9dGYwe7OzG3uwLlcy/axNauiGA0Iji4GDU5TCsoKMDPzw/l73XB/fz8CAkJITIy0hLlnJaWZvkiLl68mDlz5pCSkkL37t159913LX0tWbKE6Ohorr/+ek6ePGk5/vHHHzN48GDi4+OZMmUK1dXVqNVqoqKiMBhq5zMqKyuJjIy0vG4Ma4tReHg4Li4udY5FRUVZJhtDQkIa3AtnNpsxGo2W/7u5uQG1JbcFQcBoNCKVStm/fz8DBw5EJqtfhqcjUavVbN36I6tWf0al7vc8S0nOyORQozET7O7EM8OD8HhZjLC2KmbRM2rSMxo3bhwvvvgivXv35vrrr2fatGmMHj260WuysrLYvn07arWa6OhoHnzwQTIzM1m1ahWHDh3CaDSSmJjIwIEDAbj99tu59957AVi0aBHLli1j/vz5pKSksGnTJiZPnsyqVauYMmUKimbsleroJdLMzEz69u1b77i7uztDhgzhgw8+QC6XExUVRVRUbd7l6OhoVqxYQUREBEqlkoKCAoYPH96hdjeGyWSqF7Pk7qHkzQk9cd30OUL/AbY2sWuhUGAWl/Ybx83NjfT0dHbt2sX27duZNm0ar7zySqPXTJw4EaVSiVKpJCAggMLCQnbt2sVtt92GSlWbkmLSpEmW9kePHmXRokWUl5ej0WgYP348APPmzePVV19l8uTJLF++nI8//rgtz9ou7N27F6lUSr9+/eqd0+l0nD59mgceeAClUsn69es5duwY/fv3JykpyTLvtmXLFkaOHMnhw4fJzs4mICCAYcOGdfSjNIharcbDxUSwhxpBrkSVdAMSB4/jsjoSCUaVm62tsCnNmsCWyWSkpKSQkpJCbGwsn376KXK53JIvSPenXCxXhnRXrr0yodxQdOmsWbP47rvviI+PZ8WKFezYsQOA4cOHk5OTw6+//orJZCImJqZZD9VRUaxHjhzh7Nmz3HXXXde8Z05ODp6enhYBvjJX1L9/f0ubwsLaLH/e3t5s27aNGTNmsH79ekpLS/Hx8emQ52iI7t2juCklEU9pEc5FX1NuuJFtF5cxMegRPE6cxXFjha2PIJMh9OxuazNsSpNzRidPnuT06T8qLGRkZBAREUFkZCTp6ekAzUp6P2rUKNatW4dWq0WtVrNhwwbLObVaTXBwMAaDgZUrV9a5bubMmUyfPp3Zs5ufLbAjxOjcuXP89ttvjQ4dPTw8yM/Px2AwIAgC58+fx9e3biTzrl27GDFiBObfSyxfsd/aK4It4bpRw3j0vtuZMVJFUOFSVPmrkRrKUMtUFGqO80vRCqq6d7OZfV0RQSIBB5f3Jj0jjUbD/PnzKS8vRy6X07NnT5YuXcqJEyeYO3cuL7/8crOW+RMTE5k2bRoJCQlEREQwcuRIy7mXXnqJpKQkIiIiiI2NrTMZPGPGDBYtWsT06dOb/VDWjmL9/vvvuXDhAlqtlvfff58RI0awb98+TCYTq1evBmonscePH49areaHH35g6tSphISEWOaGpFIpgYGBxMf/UePr1KlTBAUF4f57oFtISAjLli0jICCAgICOrRahUqmYPHEMYd7gUrEX+cW1db4aZqSojbUJwHIqUjnuFkNcYG+cC7tW3iibIZHgwNvSgE5QqmjNmjWsX7+ezz//vNnXpKWlsWbNmna0qusQHh7Gzdcn4SUvxaXoJ6T6a4uL3iORbeZKzpbssByb3PNlwnINKDSOHaxnDcxOThiGDELp4bgR2Ha9HWT+/Pls2bKFzZs3t+g6ub3U+7FjhicPYUhsOK76MyiLPkZibjxqvcIrntxzb9U59t2ZRcyI/i9+WTVIbTis7AqY5XIkCsf+3Nr107/33nutuu5akdAite/LpAljiPCXoarcj/zi90honmOsRkBv+nPOHTNrzz7N9N7/wfPEOST27WTbNWYXZ6StSPHblbBrMWotV6/miUBwcDCTxiXj7VSBS/FGZLktq9NllrpQYai/Yx9AZyznx4L3mdDjftzPnLeGuQ6JoFI59I596KJi5OTkhEQicfj8MIMHJTJ8QBRuxhyURZ8gMWtb1Y/OJ5ns0tQGz+drMslw382gkMG45F9qrbkOjdnF2aETq0EXFSNnZ2fc3Ny6RLmiluLk5MTNN15Hj2BnVOo05Hmbmz0Ua4gK1+5cyv+q0TZpBV8R2L03UZ4eKCoq23Q/h0QuF8XI1ga0By4uLg4nRv7+/ky+aQS+zlU4l2xDntt0Av3mohF0mISm9wRuOvcC06Pfw1+rRaZvur3IVYiLLl1TjJycnPDx8aGgoMDWprQ7CfExjB7SBzfTBZRFnyI1WXeZ3ezkS4m2+fmK1p5+kr/0ehOv4+KEdosQxahripFUKsXPz8/WZrQbcrmcm8alEB3uhkqTgSLvfSS0z45vje9IzhZuarrh7+jNVWzIfZ3JPR/F/XS2g8cUNw8BRDGii4qRRCLBy8vL1mZYHR8fHyZPGI2/SotLyS/Ic9t/9apS6U+pNqdF15RoT3Og+geSw65DdTG/fQzrQghijBHQhcXIvQvlEu7Xty9jh/fHQ8hHWfQ50tKOmwtTG9XQignwzMvrCY7qS09vL5zKyq1uV1fCrFQidRLDUbqkGEHtJtXOjFQqZfz1o+kX5YVr9REUBf+HROjYtB1GVQ8Kq0433bABfsx+Bc/ebxNYrUUu5iVvEKOvD05KJ1ubYXO6tBj5+PhQWtq5qpt6enpy28QUAt0MuJT+iiz3jM3mXSp9hnIud1mb+vj2zBP8pee7+JzIRuLgmQwbQnBzdfiAR+jCYuTu7k737t07jRj16tWT8aPi8eAyzkVfIS2vsLVJqGVKqvTFberDaK5h/YV/cUevZ3A/eU6c0L4WLuL2JeiipYqgdpgTHh5uazOa5PoxI3n0/tu5K1lO4KWPUBV8jdRoeyGqTRlineDFCl0uu8u/oToizCr9zXn7TQL+Mo2Yh+6vd+71tWuQTLyR4or672FuURHXPfk4fe+/l/4P3sc767+znHvik2XE/e0BZr7xmuXY579sq9OmPTArFEjEvZRAFxYjiURit/NGbm5u3DNtEk/cdzPD/TLxzn0fZfF2JM0ILOwojJ4DuFBx0Gr9nSz9mdPys9T4NVwmu7nMuv4GfnjxX/WO5xYV8VPGQbr5XzsXlFwm5Y1593Lio4/Z98bbvL9xA8cvnKeiqoq9WcfJfP9DTGYzR3Ky0dbUsGLbNh6aeHOb7W0Mo5cn8t8zgTo6XVaMoHaoZk9j8cjICB6aM4W/3zWQXrpvcL/4MQpNll0OXco948gtT7dqn9svvENhgBTjnyqttJRRMbH4XGO1dMHHH/Hq7HkNJikL9vElsWcvANxVKvqGh5NXUoJUIkFvMCIIAtqaGhQyOa+tXcPfb7kVRTvH/5h8vJGJMUZAFxcjb2/vDs+YeC1GjxjKgvtu5+7RHgQXLkWVvwqpwb7nsjQI6K0czQ2w7vRTlPcIxmzlkkzf70sl1NeX+O7NyyOdU3iJQ+fOkhQdjbtKxZThIxgw/29EBQXh6ariwOlT3JqcbFUbr4mzuEH2Cl1akl1cXOjfvz+XLnX8TnKVSsWtE64j3FeKS3kq8ovr7NIDuhZmqQvlbZy4brBvjHyb/SzTev/Lakn9q3U6lqxexdZ/vdys9hqtlilL/sXb996Ph6q2ZPfjd0zl8TtqC2jOe+ctXrz7Hv734xa2HjxIXFQUi+76ixUsrYsgkYCzGF90hS7tGUmlUkJDQzv0nqGhoTw4ewqPzBhKX+N6PHKXolAf6TRCBKD1GU526d52679KX2TVpP5nLxWQXXiJ+IcfJHL2TC4WF5P4yMNcusZKqsFoZMrLLzHjuuu4ffiIeucPnT0DQO/QMD77+We+fuoZjp4/z+m85u/Pay4mNzfkrq5W77ez0qU9I6jdze7q6kpVVfvmaR42dDBJsd1wNZxrVhpXe6bSNYpL+V+06z1yKlI55taf+MDoNif1j42M4vKXqy2vI2fPJO3t9/Dz9KzTThAE5r7zFn3Du/HobVOu2dezn3/G0vmPYDAaMf0eFyWVSKhuh6BNQ1AAzmIiQAtd2jOC2v1cCQkJ7dK3s7MzU2+7iX/eP4kbonLxyXsf58ubO7UQAWjMWsxC++e03pv3Pwp8DBjcWuYdTP/Pv0l+bAEnL14kbObdLPvxhwbb5peUMOH5ZwHYc/wYn//yM78cziDh4YdIePghNh/Yb2n7XepeBvfuTYivL15ubiT36UvsQw8gkUiaPRfVXAQAD3dxvugq7L46iDU4evQoX3xhvV/6oKAgJo0fho9TJS7F25DVdJ1UJSYnfw549ufAxfb1jP5A+ntS/4sOldTf6O6GeVAiTm1cWexKdPlhGoCvry9KpZKaNrragxITGDGwB27G821K42rPVPmO4Ezh9x14x9qk/nf1/g9eDpTU3xASLBaO+BMOIUb+/v7079+fgwdbHsTn5OTExPEp9AxRodKkI8/7sd1yB9kDlUpfyrQXOvSeOmM5Wx0oqb8A4O4mDtH+hEOIkUwmo3fv3i0SI39/f269cQR+LtU4l/yMPDe3HS20D8yA2qihNSlD2oojJfU3ensht9PdAbbEIcRIIpHg5+eHk5MTer2+0bZxsf25bmhf3Ey5tWlcSxynWqrZtRcFmpM2u7+jJPU3BgWKq2jXoMuvpl0hKCiIwYMHX/OcXC7n5pvGsvD+25gcX41f3vu4XPrO6vmk7Z0K76R2jS9qDpvOvUBJuCcmp65Z0FCQSMBNHKJdC4fwjKBWcKKjo9mzZ4/lmLe3N5MnjCbAtQaX0u3Ic7NtaKHt0cicqG6gWGNH0pWT+ht8fFCIQ7Rr4jBiBLWVVbt164aryoXrh8fiQQHKopVIy7rukKC5mJFSabB96hLo2kn9jSGBuHRRr6+tOESc0RUEQaAkLwuXilScSnd3eBpXe6bGcwjbjEWcK91la1MsxAXcSrKk6yT1N7k4YxyUiLIL5We3Jg4zZwS1E9lu7l4oKg/bRIjmvbKHkFu/JmFW/TieN1cdQzH6M4rLdQ1ebzKZGTR3A7c++bPl2FMfpjNg9vfMWrLbcuyLH8/y7poTLbKtwiuG3ArrpgxpK5mX15PjUoDe28vWplgFfWQETm5utjbDbnEoMQJQegRhDL7FJvf+60092fja2HrHcy9XsS0tn26BjW+LeHdNFn0j/thvVaHRk3q0iEPLJ2EyCxw5W4a2xshnP5zlwcnRLbJNLZgwmKpbdE1H8GPOfygKUWHs5AGCZoUCiZenOHHdCA4nRhKJBDx7IUg7Pgx/ZHwgPu71l3QX/vcA/35gYINJwQAuXq5iy76LzLm5l+WYVCpBbzQjCAK6GhMKuZQ3vjrGw1P6oJA3/09rlqqoaKeUIdbg2zNPUNEjFMGOEuW1lJqIcJz+tHH3zyxYsIC3337b8nr8+PHMmzfP8vqxxx7jzTffbPJeOTk5xMTEtNrW5uDWDh5e5/3rtgFnz3AMQeNtbQYAG/bkEuKnIr6nT6PtHvtdsKRXKZa7SsHto7oxaN5GIoPd8HRTkJZVwqQRLUvNofUdztnSPU03tBFXkvqre0XaIByz7ZjlcvD1aTLr6LBhw9i7tza0wmw2U1xczLFjxyzn9+7dy/Dhw9vVVlvikGIklUrBJ94m3tHVVOuM/PvzIyyek9Bou017L+Lv5czA6Pr5oxf+JYb0Zbfw2t8G8fyyDJ6fE8+yjaeZ/vyvvPxZZrPsqHCN5LImqzWP0GFYO6l/R1IT2Q2lt3eT7YYPH24Ro2PHjhETE4O7uztlZWXU1NRw4kTtPODo0aMZOHAg48ePp6CgdpN2eno68fHxJCcn8/7771v6XLFiBbfffjs33ngjvXr14vHHH7ec27p1K8nJySQmJjJ16lQ0Gg0ATz75JP369SMuLo6FCxcCkJ2dTXJyMoMHD+bZZ5+19KHRaBg7diyJiYnExsayfv16AJ599lneeecdS7tnnnmGd999t9Hnd0gxAnD2isQQdodNbTibpyanQMPAuRvoOW0tF4uqGXLvRi6V1N2Au/foZTbuvUjPaWuZ8eJOth+8xMx/1V31OnSqNj6od7gHX/x4lq9eGM2x7HJOX2w6bKHK1DEpQ9qKNZP6dxTN9YoAQkJCkMvlXLhwgb1795KcnExSUhKpqamkpaXRt29fFixYwJo1a0hPT2fOnDk888wzAMyePZt3332X1NTUev1mZGSwevVqjhw5wurVq8nNzaW4uJh//etfbNu2jYMHDzJo0CDefPNNSktLWbduHceOHSMzM5NFixYB8Mgjj/Dggw9y4MABgoKCLH07Ozuzbt06Dh48yPbt23nsscdq80bNncunn35a+x6YzaxatYoZM2Y0+vwOFWd0NVKpFKlPDKbCIGQ1ttkLFdvDm/z1d1pe95y2ln0fTcTPq+5k7ZL7EllyXyIAvx66xJurj/HZopF12iz+JIMPFiZjMAqYzLWDGamk1vtqDJNTIMXazrPvbvuFd/Dp9RohVS7ItfafNaG5XtEVrnhHe/fu5dFHHyUvL4+9e/fi6elJaGgoW7du5YYbbgDAZDIRHBxMRUUF5eXljB49GoB77rmHLVu2WPocO3Ysnr/PV/Xr14/z589TXl7O8ePHLcM+vV5PcnIyHh4eODs7M2/ePCZOnMjNN9dWR9mzZw9r16619P/EE08AteEyTz/9NDt37kQqlZKXl0dhYSGRkZH4+vpy6NAhCgsLGTBgAL6+jf+IOKwYASjdA6kOn4rszHsdcr+7X9jJrxmFFFfoiLxjDc/NjmfOxF7XbJtfXM39r6ay4dX6q29/Zv2uCwzq40eIX23Jm6H9/UmY9T2xPbybnIvS+I7gTOF3LX4WW7Lu9JPMiP4vPicuIDXZb6yYycUZSYB/iyrUXJk3OnLkCDExMYSHh/PGG2/g4eHBmDFjyMvLq+f9lJeXN7pKp7xqH5xMJsNorK2EcsMNN/DVV1/Va79//35+/vlnVq1axX//+19++eUXgGveY+XKlRQVFZGeno5CoSAyMhKdrjY8Zd68eaxYsYJLly4xZ86cJp/dYYdpUPvmKrx7YfSM75D7ffH8KHLXTUX7yz3krLmjnhCdWT3F4hWF+KmuKUSjBwSx/pW6x28d2Y1nZ/3xDK8+NIiMFZP4/NmRf768HmonH8q1nStthxkT32Y/R2Vv+53QFoCaXj1QNrGC9meGDx/Oxo0b8fHxQSaT4ePjQ3l5OampqUybNo2ioiKLGBkMBo4dO4aXlxeenp7s3l0ba7Zy5com7zN06FD27NnDmTO1Ob+rq6s5deoUGo2GiooKJkyYwNtvv01GRobFrlWrVtXrv6KigoCAABQKBdu3b+f8+T8+S7fddhs//PADBw4cYPz4pheMHFqMABTOHpiCb0JwwLfCDKhNalub0Spqk/ovt1pSf2tjCA5C4efX4rii2NhYiouLGTp0aJ1jnp6eBAQEsGbNGp544gni4+NJSEiwTHgvX76cv/3tbyQnJ+PSjOyR/v7+rFixgunTpxMXF8fQoUPJyspCrVZz8803ExcXx+jRo3nrrbcAeOedd3j//fcZPHgwFVdV650xYwZpaWkMGjSIlStX0qdPH8s5JycnrrvuOu68805kzShN5VDbQRrCaKhBf24dToVbmm7chTC6RvOrwpnjhZtsbUqrGRY6j3ht25P6WxOzXEbNgARc/P1sbYpNMZvNJCYm8s0339Cr17WnI67G8dyBayBXKMF/KILMscoMV/gMIae0/upLZ6K1Sf3bk5qePVD6Nj5X19U5fvw4PXv2ZOzYsc0SIhA9IwtmsxntxV0ocz6xtSkdRk7EHDacerHRNqveOMHxfcW4eTnx+MdJAPzw2Tn2bcnHzdMJgAlzutNvSH0v4MSBEr774DRms8DQG4MZe1ckABv+d4asAyWE9nDnL4/3AyBtWwHVaiOjbgtvxZPYT1J/o6cHpvhYlOIetBYjeka/I5VKUfglYPAZ2nTjLoAZOepmpAwZfEMQ972cUO/46Nu7sfDDISz8cMg1hchsEvj2vye5b0k8T3ycxMEdl7l0vgptlZGc4xX886MkzCaB/GwN+hoTB7ZeYvgtrS24WZvUv6J3RG3yMhshSCTou0fhJBZmbBWiGF2Fk8oTIXQiZkXXd7ENngM5X57WZLsecd6o3FseAXLhZCV+ISp8g12QK6QMGB3A0b1FSCRgMggIgoBBb0Ymk7D9mwuMnByGrAX76f7MlaT+mh62m9CuiQhH6ecrboZtJaIY/QkXr3D0UbO7/OpauVcMFytaXi3lCru/v8hr9//GqjdOUK021DtfUVyDl/8f8S1e/koqSmpwVsmJG+nPGw8ewCfIGRdXObknK4kZ5t9qW66Qr8kkQ78bbUhQ042tjNHDHUJCkCnExGmtxaGDHq+FRCLB2a8PNdVTUV5c3fQFnRSNYMTQyrpvw28JY9yMKJDAD5+e4/ulZ7jrsb512lxrIvKKxzDmzgjG3BkBwOo3T3DjX7uzb0s+J9NLCYly5YYZUa2yC2yT1N8sl6Pv3QsXTzGdbFvo2j//rUQud0IekITRI87WprQLZpkr5frLrb7e3dsJqUyCVCph6E0hXMiq/6X38lNSXvRH0czyoho8fJzqtLl4pjbGyT9URdpPBfx1UQwFOVUU5bUtr1JHJvUXAF2/Prj4tzymSKQuohg1gNLNF1P4bZjlXW9VROs7gnMlra8CUlnyh8gc2VNEUGT9CdvwaHeK8qopKdBiNJg59OtlYpLrTnT/8Ok5bvxrd8wmM+bf62JKpBL0urZv8Vh7+kkqe3Vr9wltXa8eKAMDRCGyAuLSfiMIgkB1wUGczryHxG43HrScgsh7WXvqRYRmpN79/OWjnMksp6rCgLu3E+PvieJsZhl5ZzVIJOAT6MLUR6Lx8K2dE1r9Zhb3LandmnJ8fzHrf1/aHzI+hBv+Emnp98ieIvLPaRh/T+2Q7Pulp8lKKyUkyo27n+pvlef0denF5MD2S+qvDwqA6N7i6pmVEMWoCQwGLfoL21DmrbG1KVbjVPgMfjzzH1ub0SG0V1J/k6sKQ1wMzi3YkS/SOOIwrQkUChcUIaPRB95oa1OsglEZ3KlShrSV9kjqb5bJqOnTG6WX9foUEcWoWTi5eCALG4/Bb5StTWkzVb7DOFuy09ZmdCjWTOovSCTo+kXj7O8vzhNZGVGMmonS1QdJ+C0YvQba2pQ2oXbyoVx30dZmdDjWSOovSCRo+0ajDA5uUY4ikeYhvqMtwNk9ACHiDozufZpubIeYAbXRMavntjWpvwC1QhQWikwuhue1B6IYtRBnj2DMkTMwudhnHp3GMLn1IV/dsuKOXYnWJvUXAG2/aJShIaIQtSOiGLUQiUSCi1c4xu5zMDsF2NqcFlHpPYTsss6dMqSttDSpv8UjCg0Vt3q0M6IYtQKJRILKJxJDj/sxKzpPpQq1VI7WUGZrM2zO9gvvUBggxdhERkQB0PbpXTs0E4Wo3RHFqJVIJBJUfj0w9H4YkyrC1uY0iRk5lYZyW5thN6w7/SRlPYIwN5AO1SJE4WGiEHUQohi1gVoPKQpzz/swesTa2pxGMXgPblbKEEfBjIl1DST1r101640yTBSijkQUozZSO4cUBt3vweDXdDUOW1Hu0a9NKUO6ItdK6m+Wy9HG9kcZHo6sAzbaivyBKEZWwtkjEGnEFGpC70Bol51QbUMjGDGadbY2w+44X7GPY+YMdIH+mFxc0MXH4CKumtkEUYysiNLVG6du16Pvfj+CxKnpCzoIs9ytTSlDujp78/5HsZ+Mmtj+uASIO/BthU3FqKSkhISEBBISEggKCiI0NJSEhAS8vLzo169fu99/xYoVPPzww1btU6FwwSUkCX3vf2BW2McmSq3PCM6W7LG1GXaKhKERc3HzDUElpoy1KTb1RX19fS0VKxcvXoybmxsLFy4kJyfHUuO7NRiNRuQ2dLOlUimqgH5onRYgyf8Jeckumw7cKlThXL540oYW2CdOMjfG9n6cqMBElIqmCx+KtC92O0wzmUzce++99O/fn3HjxqHV1qZITUlJIS2tdlWouLiYyMhIoNbLmTp1Krfccgvjxo2joKCAUaNGkZCQQExMDLt27QJqK2/27t2b0aNHs2fPH97Chg0bSEpKYsCAAVx//fUUFhZiNpvp1asXRUW1BQLNZjM9e/akuLi4SfslEgkq7whkPaah7/4gZpntct5oTNXNyl3kSAS69WdS7L/pHZIsCpGdYLdidPr0af72t79ZaomvXbu2yWtSU1P59NNP+eWXX/jyyy8ZP348GRkZHD58mISEBAoKCnj++efZs2cPP/30E8ePH7dcO2LECPbt28ehQ4e46667ePXVV5FKpdx9992W2uLbtm0jPj4eP7/mVwp1cnZHFZqEsc9CjN6DW/5GtBGjcwhF2vNNN3QQ5FJnRvdYwISYRYT59RU3vNoRdrtkEBUVRUJCAgADBw4kJyenyWtuuOEGfHxqywwNHjyYOXPmYDAYmDx5MgkJCfz888+kpKTg719biWLatGmcOnUKgIsXLzJt2jQKCgrQ6/VERdVmIJwzZw633nor//jHP/jkk0+YPXt2i59FIpGg8u2O3uUeaorjcbrwBZIOWtmq8h3O2fyvO+Re9k5PvxQGhE0lxLe3KEJ2iN3+RZTKP8rcyGQyjL9XCpXL5Zh/T5is09X9Qrtelf5z1KhR7Ny5k9DQUO655x4+++wzgAYnKOfPn8/DDz/MkSNH+Oijjyx9h4eHExgYyC+//MJvv/3GTTfd1OpnclJ54hI2HH2ff2J0j2l1Py2hUuFJhS6vQ+5lr6gUPtzY53nG9Pk7Yf59RCGyUzrdXyUyMpL09HQA1qxpOBXs+fPnCQgI4N5772Xu3LkcPHiQpKQkduzYQUlJCQaDgW+++cbSvqKigtDQ2oqmn376aZ2+5s2bx913382dd96JrIHtA81FKpWi8u2BpPdcaiLnYJa3X3mb2pQh6nbr396RICUh5E5ujXuVPmEjcXXxtLVJIo1gt8O0hli4cCF33nknn3/+OWPGjGmw3Y4dO3jttddQKBS4ubnx2WefERwczOLFi0lOTiY4OJjExERMptqJ3cWLFzN16lRCQ0MZOnQo2dnZlr4mTZrE7NmzWzVEuxYSiQSlqw8Kl5HUeHTHUHoMp/zvkLSyjllDmNz7kVd5zKp9dhZ8VT0YHnU/Yf79xAnqToKYkL8ZpKWlsWDBAsuKnLUxm83oyi9A6SEUBZuQCPUrtLaG4vCZfJfzf2iN5VbprzPg6RzGkG73EOLdH2/3IDFuqBPR6TyjjuaVV17hgw8+sKyotQdSqRSVTyRGjzD0XrFQvB9F0TYkbVyO10hlDiNE/q69GRg+nSCv3ni5BYoi1AkRPSM7xGjUU1OWjfTyLuQlu1tVs82MnKMht/Br9nvtYKH9EOwez4DwqQR79sLdVYyg7syIYmTHGGq0GCovIKjPoCjcirQF+Yi0PsP4SXeB82X72s9AGxLpnUxsyK0EefXC1cVTFKEugDhMs2MUShcU/tGYfXuh9xuIQZOHtCQVeVk6EsyNXlvp3o+8wu87yNKOQSlzIzpgHFG+yQR598JF6SaKUBdCFKNOgFQqxdkjCME9EKNffwyVN4LmHPJLW5Hqi655jVrQd4mUIQqZit7+Y4nwGYKPaxg+7qFtDq8QsU9EMepESCQSFE7OKPx6Ivj2oMZ3AAbNRSTlR5GXHUBqrADALPegvKbzpgyRS53p6ZdClG8y3q5h+LqH2XTjs0jHIM4ZdQFMJhOG6mLM1cWgzafGLPDD5Y1cUneeGCOl3J0IryS6+w3H2zUMP49wZDK5OAxzIEQx6mIIgkC1Vk2F9jIa3WXKqi9yrmQPRZqTmKwUv2QN3JVBRHgPIcijP+7O/rg5++KpCkQuFwXIURHFqIsjCAI6fTUVmkKqDeXoDGp0hkpKq89TpD5FRU0e2nasGqKQqXBz8ifYI5ZA92hclT6onLxxc/bFzcUbqVQqio8IIIqRQyIIAmazGaNRT1XNFYGqFSmtvhKdsRKjuQajqXYS3GTWYzDrMJpqMJh0mAQ9ZsGIVCLDXRmMp0sQrk7+OMlUKOTOKGQuOMlq/6+QKXF2csdF6S4Kj0ijiGIkUgdBELj6I3Hl31f/XxDMmMxGpBIpMpnCIjKi0Ii0BVGMRERE7IJOl0JEpGvRUFGGhIQE9Hq91e6zY8eONuVVF2l/xOANEZvSUFEGEcdD9IxE7I5Zs2bVSZzn5uZm+fdrr73G4MGDiYuL4/nnnwegqqqKiRMnEh8fT0xMDKtXrwbghx9+oE+fPowYMYJvv/3W0sf+/fsZNmwYAwYMYNiwYZw8WVs5ZeTIkRZhBBg+fDiZmZnt+agiVyF6RiKdhq1bt3L69Gn279+PIAhMmjSJnTt3UlRUREhICJs2bQJqs3bqdDruvfdefvnlF3r27Mm0adMs/fTp04edO3cil8vZtm0bTz/9NGvXrmXevHmsWLGCt99+m1OnTlFTU0NcXJytHtfhED0jkU7D1q1b2bp1KwMGDCAxMZGsrCxOnz5NbGws27Zt44knnmDXrl14enqSlZVFVFQUvXr1QiKRcPfdd1v6qaioYOrUqcTExLBgwQKOHauNVJ86dSobN27EYDDwySefMGvWLBs9qWMiekYidsfVRRcEQbBMZAuCwFNPPcX9999f75r09HQ2b97MU089xbhx45g0aVKDoQbPPvss1113HevWrSMnJ4eUlBQAVCoVN9xwA+vXr+frr7+21OcT6RhEz0jE7ri66ML69esxGGq3sYwfP55PPvkEjUYDQF5eHpcvXyY/Px+VSsXdd9/NwoULOXjwIH369CE7O5uzZ88C8NVXX1n6v7r4wooVK+rce968efz9739n8ODBlrJXIh2D6BmJ2B333nsvt956K0OGDGHs2LGWElTjxo3jxIkTJCcnA7UT21988QVnzpzhn//8J1KpFIVCwQcffICzszNLly5l4sSJ+Pn5MWLECI4ePQrA448/zl//+lfefPPNekUdBg4ciIeHh9WKL4g0HzHoUUTkKvLz80lJSSErK0usr9bBiO+2iMjvfPbZZyQlJbFkyRJRiGyA6BmJiIjYBaL8i4iI2AWiGImIiNgFohiJiIjYBaIYiYiI2AWiGImIiNgFohiJiIjYBaIYiYiI2AWiGImIiNgFohiJiIjYBaIYiYiI2AWiGImIiNgFohiJiIjYBaIYiYiI2AWiGImIiNgFohiJiIjYBaIYiYiI2AX/D8weCkuoUvcfAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "labels= ['Friday', 'Monday', 'Saturday', 'Sunday', 'Thursday', 'Tuesday', 'Wednesday']\n",
    "# counting the number of times a weekday appears in the dataset\n",
    "start_date, counts = np.unique(trips.column('day'), return_counts=True)\n",
    "weekday_table = Table().with_columns('date', start_date, 'count', counts)\n",
    "plots.pie(weekday_table.column('count'), labels = labels, autopct='%1.1f%%')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3a82d69b",
   "metadata": {},
   "source": [
    "#### Insight:\n",
    "The traffic seems to spread evenly across all days of the week, although there is a little bit less traffic on the weekend"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3ede2623",
   "metadata": {},
   "source": [
    "## 3) Analyze the busiest hours"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7464c01e",
   "metadata": {},
   "source": [
    "The number of journeys each hour is an essential indicator of traffic patterns throughout the day, to investigate this the number of starting and ending trips each hour, the total number of trips were aggregated. The task of relocating bikes to meet demand is highly time dependent, and the graph of these results show clear patterns.  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "3ffb7d2b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>start_time</th> <th>end_time</th> <th>bikeid</th> <th>tripduration</th> <th>from_station_id</th> <th>to_station_id</th> <th>date</th> <th>day</th> <th>start_hour</th> <th>finish_hour</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:59:58</td> <td>10/1/2017 00:05:47</td> <td>1411  </td> <td>349         </td> <td>216            </td> <td>259          </td> <td>9/30/2017</td> <td>Saturday</td> <td>23        </td> <td>0          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:59:53</td> <td>10/1/2017 00:05:47</td> <td>3048  </td> <td>354         </td> <td>216            </td> <td>259          </td> <td>9/30/2017</td> <td>Saturday</td> <td>23        </td> <td>0          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:59:06</td> <td>10/1/2017 00:02:52</td> <td>2590  </td> <td>226         </td> <td>141            </td> <td>144          </td> <td>9/30/2017</td> <td>Saturday</td> <td>23        </td> <td>0          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:58:56</td> <td>10/1/2017 00:07:37</td> <td>551   </td> <td>521         </td> <td>96             </td> <td>217          </td> <td>9/30/2017</td> <td>Saturday</td> <td>23        </td> <td>0          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:58:47</td> <td>10/1/2017 00:07:37</td> <td>1287  </td> <td>530         </td> <td>96             </td> <td>217          </td> <td>9/30/2017</td> <td>Saturday</td> <td>23        </td> <td>0          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:58:45</td> <td>10/1/2017 00:16:37</td> <td>6132  </td> <td>1072        </td> <td>478            </td> <td>117          </td> <td>9/30/2017</td> <td>Saturday</td> <td>23        </td> <td>0          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:57:19</td> <td>10/1/2017 00:05:36</td> <td>5235  </td> <td>497         </td> <td>114            </td> <td>296          </td> <td>9/30/2017</td> <td>Saturday</td> <td>23        </td> <td>0          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:57:12</td> <td>10/1/2017 00:00:46</td> <td>54    </td> <td>214         </td> <td>87             </td> <td>127          </td> <td>9/30/2017</td> <td>Saturday</td> <td>23        </td> <td>0          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:56:59</td> <td>10/1/2017 00:20:17</td> <td>3823  </td> <td>1398        </td> <td>90             </td> <td>86           </td> <td>9/30/2017</td> <td>Saturday</td> <td>23        </td> <td>0          </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>9/30/2017 23:56:52</td> <td>10/1/2017 00:14:44</td> <td>5794  </td> <td>1072        </td> <td>296            </td> <td>268          </td> <td>9/30/2017</td> <td>Saturday</td> <td>23        </td> <td>0          </td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>\n",
       "<p>... (2277499 rows omitted)</p>"
      ],
      "text/plain": [
       "start_time         | end_time           | bikeid | tripduration | from_station_id | to_station_id | date      | day      | start_hour | finish_hour\n",
       "9/30/2017 23:59:58 | 10/1/2017 00:05:47 | 1411   | 349          | 216             | 259           | 9/30/2017 | Saturday | 23         | 0\n",
       "9/30/2017 23:59:53 | 10/1/2017 00:05:47 | 3048   | 354          | 216             | 259           | 9/30/2017 | Saturday | 23         | 0\n",
       "9/30/2017 23:59:06 | 10/1/2017 00:02:52 | 2590   | 226          | 141             | 144           | 9/30/2017 | Saturday | 23         | 0\n",
       "9/30/2017 23:58:56 | 10/1/2017 00:07:37 | 551    | 521          | 96              | 217           | 9/30/2017 | Saturday | 23         | 0\n",
       "9/30/2017 23:58:47 | 10/1/2017 00:07:37 | 1287   | 530          | 96              | 217           | 9/30/2017 | Saturday | 23         | 0\n",
       "9/30/2017 23:58:45 | 10/1/2017 00:16:37 | 6132   | 1072         | 478             | 117           | 9/30/2017 | Saturday | 23         | 0\n",
       "9/30/2017 23:57:19 | 10/1/2017 00:05:36 | 5235   | 497          | 114             | 296           | 9/30/2017 | Saturday | 23         | 0\n",
       "9/30/2017 23:57:12 | 10/1/2017 00:00:46 | 54     | 214          | 87              | 127           | 9/30/2017 | Saturday | 23         | 0\n",
       "9/30/2017 23:56:59 | 10/1/2017 00:20:17 | 3823   | 1398         | 90              | 86            | 9/30/2017 | Saturday | 23         | 0\n",
       "9/30/2017 23:56:52 | 10/1/2017 00:14:44 | 5794   | 1072         | 296             | 268           | 9/30/2017 | Saturday | 23         | 0\n",
       "... (2277499 rows omitted)"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "start_hour_array = [\"\" for i in range(trips.num_rows)]\n",
    "finish_hour_array = [\"\" for i in range(trips.num_rows)]\n",
    "# extracting the date portion from start_time variable\n",
    "for i in np.arange(trips.num_rows):\n",
    "    # hours are formatted differently in each dataset\n",
    "    if (len(trips.column('start_time')[i].split(' ')[1].split(':')[0]) > 1 and \n",
    "        trips.column('start_time')[i].split(' ')[1].split(':')[0][0] == '0'):\n",
    "        start_hour_array[i] = trips.column('start_time')[i].split(' ')[1].split(':')[0][1]\n",
    "    else: \n",
    "        start_hour_array[i] = trips.column('start_time')[i].split(' ')[1].split(':')[0]\n",
    "    if (len(trips.column('end_time')[i].split(' ')[1].split(':')[0]) > 1 and \n",
    "        trips.column('end_time')[i].split(' ')[1].split(':')[0][0] == '0'):\n",
    "        finish_hour_array[i] = trips.column('end_time')[i].split(' ')[1].split(':')[0][1]\n",
    "    else: \n",
    "        finish_hour_array[i] = trips.column('end_time')[i].split(' ')[1].split(':')[0]\n",
    "trips = trips.with_columns('start_hour', start_hour_array, 'finish_hour', finish_hour_array)\n",
    "trips"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "0c2c668e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>start_hour</th> <th>count</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>17        </td> <td>266116</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>16        </td> <td>212425</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>18        </td> <td>185283</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>8         </td> <td>169488</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>15        </td> <td>151542</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>13        </td> <td>136228</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>14        </td> <td>136042</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>12        </td> <td>135230</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>7         </td> <td>130595</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>19        </td> <td>123316</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>\n",
       "<p>... (14 rows omitted)</p>"
      ],
      "text/plain": [
       "start_hour | count\n",
       "17         | 266116\n",
       "16         | 212425\n",
       "18         | 185283\n",
       "8          | 169488\n",
       "15         | 151542\n",
       "13         | 136228\n",
       "14         | 136042\n",
       "12         | 135230\n",
       "7          | 130595\n",
       "19         | 123316\n",
       "... (14 rows omitted)"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "start_hour, start_hour_count = np.unique(trips.column('start_hour'), return_counts=True)\n",
    "start_hour_stats = Table().with_columns('start_hour', start_hour, 'count', start_hour_count).sort('count', descending=True)\n",
    "start_hour_stats"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "80de0927",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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sbGxPVa9DgT19fWen0+ePBlw9zcC0ahRo7Db7Z4Zm7/97W/1OpEAptlrQ+z555+nurqalpYWIiMjWb58ORkZGRQUFJCQkMCCBQv8XeKQ8Tb2yspK6uvrMZlMOBwO1q5dO2ynTHsbv9Vq5Ze//CVXrlxh5MiRTJw4kUcffdTfpQ65Cxcu8OKLL9LR0UFMTAzr168PmJvrvn4HBCqFjoiIGEaX10RExDAKHRERMYxCR0REDKPQERERwyh0RETEMAodkRtw4cIF9u/fj8vlGvRjf/TRR+zfv5+urq4B912+fDlvvPHGoNckMlgUOiI34MKFCxw8eHDIQufgwYPoaQYZjhQ6IreIjo6OYRU07e3t/i5BbkF6OFTEh7q6Ovbu3csnn3xCa2srERERJCQk8Cd/8if88z//c6/98/PziYmJ4e233+b999+nrq4Ot9vNuHHjWLp0KdOmTfPs29DQwIYNG1i9ejUXL17k/fff59KlS3znO9/hP/7jP3ode//+/f2qefny5WRlZREREcGRI0doaWnh29/+NmvWrCEuLs6zn9vt5siRI7z77rs0NDQQHh7O3XffzYoVKzyvn+iucf369aSnp3v6fvTRRzzxxBNs3bqVqVOnAvD444/T2dnJAw88wP79+6mtrWXlypUsWrSoX3VL4NCrDUR8eOaZZwgLC2PNmjVERETgdDqprKxk+vTpZGVlcejQIXJzcz3L+ERFRQHXf1nPnz+f6OhoOjs7OXXqFHl5eWzZsoXU1NQe33Ho0CHi4+NZu3YtXV1dfPvb3+arr76ipKSEJ598ErN54Bcj3n//fWJjY8nOzqajo4PXXnuNZ599lueffx6LxQJcf71EUVERf/7nf8706dOpra1l3759fPbZZzz++OM39L319fW8/PLLLF26lNGjRwfMMjcyMAodES+uXLlCfX09f//3f09aWpqn/d577wVgzJgxAEycONHzc7fvfe97np+7urpISkqivr6ed999t1fojBo1ikceeaTHy+y6QywhIcETEgNhsVj48Y9/TFDQ//313rFjB+fOneOOO+7A5XJx5MgR5s2bx+rVqwFISUkhIiKC/Px8Kisre4y5v1paWnjssceYOHHigPtK4FDoiHgRHh7O6NGj2bt3L5cuXWLq1Kn9ftleTU0N+/fv59NPP+XKlSue+zTeVtSeMWPGoL89NTk5uUfgTJgwAYDGxkbuuOMOzp49S3t7O3PmzOnR75577uHnP/851dXVNxQ60dHRChz5RgodES9MJhOPPfYYBw4c4PXXX6elpYWYmBgWL17c58rgjY2NPPnkk4wfP57s7GwcDgcWi4V9+/bxxRdf9Np/1KhRg177H17W6g6g7hv73TPuui8HdrNYLFit1huekfeHxxPxRqEj4sPo0aPZsGEDbrebzz77jLfffptf/OIXREdH++xTVVXF1atX2bRpU493JX311Vde9x/ss5z+6A6lS5cu9Zhc0NnZicvl8mwPCQkBrs+q+7qWlhaDKpXhSFOmRb6ByWRi4sSJnns1n3/+uefsoa2trce+3Z+/fi+mrq6OTz75pN/fFxwc7PXYg2XKlCkEBwdz7NixHu3l5eV0dnaSmJgIQGRkJMHBwfzud7/rsV9lZeWQ1CWBQWc6Il589tlnvPLKK8yaNYsxY8bQ1dVFaWkpFouFP/7jP/bM7nr77bdJT0/HYrHwR3/0RyQlJWGxWCgoKGDRokU0Nzdz4MABHA5Hv5/B6X6r5ptvvklqaipms5n4+PhBG5vVamXhwoUUFRUxYsQIUlNT+eKLL3jjjTe48847PVO7TSYTs2bN4je/+Q2xsbHExsZSWVlJdXX1oNUigUehI+JF9yuWjxw5QlNTE8HBwUyYMIEf//jHTJo0CYDvfve7FBcX89577+F2u8nPzycuLo6NGzeyf/9+nn32WUaPHs3KlSupqqrq9y/r6dOns2DBAv7zP/+Tf/3Xf8Xtdvf7OZ3+WrFiBREREbz77ru88847hIeHM3fuXFauXNljunR2djZut5sDBw7Q1dXFrFmzWLVqFXl5eYNajwQOPRwqIiKG0T0dERExjC6vidwGurq6+rwnZDKZbmgVARGjKXREbgNPPvlkn/eE5s2bxw9/+EMDKxK5MbqnI3IbqKuro7W11ef28PBwYmJiDKxI5MYodERExDC6CCwiIoZR6IiIiGEUOiIiYhiFjoiIGEahIyIihvl/BO9HKdiDqdYAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "start_hour_stats.bar('start_hour')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "689738de",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>finish_hour</th> <th>count</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>17         </td> <td>269170</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>18         </td> <td>203110</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>16         </td> <td>198238</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>8          </td> <td>171195</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>15         </td> <td>148348</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>19         </td> <td>136928</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>13         </td> <td>135219</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>14         </td> <td>134281</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>12         </td> <td>132151</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>7          </td> <td>113516</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>\n",
       "<p>... (14 rows omitted)</p>"
      ],
      "text/plain": [
       "finish_hour | count\n",
       "17          | 269170\n",
       "18          | 203110\n",
       "16          | 198238\n",
       "8           | 171195\n",
       "15          | 148348\n",
       "19          | 136928\n",
       "13          | 135219\n",
       "14          | 134281\n",
       "12          | 132151\n",
       "7           | 113516\n",
       "... (14 rows omitted)"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "finish_hour, finish_hour_count = np.unique(trips.column('finish_hour'), return_counts=True)\n",
    "finish_hour_stats = Table().with_columns('finish_hour', finish_hour, 'count', finish_hour_count).sort('count', descending=True)\n",
    "finish_hour_stats"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "c33e6321",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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rKzscd++ntuXtLS0WwJn3LhxAJ5znT17lvb2dubOnXvLcXPmzCEoKMjnKO/rxMfHK3DEK410RG7TV6eMgoODaW9v97l/REQEmzdv5uDBg+zduxen00lSUhIPPfQQM2fOvKNz96VGwHMuh8MB3LjT7suCgoKwWCye7X311fOJ3KSRjoiBxo8fzzPPPMMbb7zBiy++yMiRI9m5cyd/+tOf/FLPzVC6cuXKLe2dnZ04HA7P9ps3MHR0dNyyX2tr68AXKcOKQkfED4KCgkhJSeH73/8+brebzz//3C91pKSkEBISwrFjx25pr6qqorOzk9TUVABiYmIICQnpFo5686v0labXRAxy6tQpSktLmT59OgkJCfz1r3/lP/7jPwgPD/fb8zwWi4UFCxZQUlJCWFgYGRkZfP7557z99tvcddddnmtLJpOJWbNm8bvf/Y7ExEQSExM5ffr0bV/zkcCl0BExyOjRowkNDeVf//VfuXLlCmFhYSQnJ/Pcc8/59bXly5YtIzo6mt/+9rccPXqUqKgo5s2bx/Lly2+5XTovLw+32817771HV1cXs2bNYuXKlRQUFPitdhl69OZQERExjK7piIiIYTS9JjLEdHV10dMEhclkuq1VBESMoNARGWJ+9rOf9XgBf/78+Z514kQGG13TERliGhoacDqdPrdHRUWRkJBgYEUivafQERERw2jiV0REDKPQERERwyh0RETEMAodERExjEJHREQM8/8A42nriLZ4jO4AAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "finish_hour_stats.bar('finish_hour')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "576299cf",
   "metadata": {},
   "source": [
    "#### Insight: \n",
    "The 5 busiest hours are: 17, 16, 18, 8, 15"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "54afaef0",
   "metadata": {},
   "source": [
    "## 4) Statistics of trip duration"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "849001ac",
   "metadata": {},
   "source": [
    "Investigating the length of customer bike trips is important for predicting necessary bike supply and station capacity. To present our findings, we gathered summary statistics of the data, by collecting the mean, median, maximum and minimum journey times we are able to make important estimations.  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "38b29484",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th> </th> <th>statistics</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>mean  </td> <td>966.435   </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>median</td> <td>697       </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>max   </td> <td>86014     </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>min   </td> <td>60        </td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "       | statistics\n",
       "mean   | 966.435\n",
       "median | 697\n",
       "max    | 86014\n",
       "min    | 60"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "trip_duration = trips.column('tripduration')\n",
    "trips_stats = Table().with_columns(' ', ['mean', 'median', 'max', 'min'], \n",
    "                                 'statistics', [np.mean(trip_duration), np.median(trip_duration ), np.max(trip_duration ), np.min(trip_duration )])\n",
    "trips_stats"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7c2d6d3d",
   "metadata": {},
   "source": [
    "#### Insight: \n",
    "There is a huge difference between the maximum trip duration and the minimum trip duration, ranging from 1 minute to almost 24 hours. The average trip duration is 16 minutes"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d45f7ced",
   "metadata": {},
   "source": [
    "# EXPLANATION OF THE PROBLEM"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "877b3308",
   "metadata": {},
   "source": [
    "## What Are We Trying to Solve?"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f364b1d3",
   "metadata": {},
   "source": [
    "The model aims to find the optimal schedule and logistic system of repositing of bikes across Chicago and Evanston."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3e9d8faa",
   "metadata": {},
   "source": [
    "## What Are We Optimizing?"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "03558a93",
   "metadata": {},
   "source": [
    "We are optimizing the transport services, and therefore minimizing the operational costs, for DIVVY. The model aims to minimize the number of transports between stations while still meeting customers’ demand. Due to limitations in out computational resources, we have narrowed our recommendation to the optimal schedule for the 5 busiest stations in the city. For the remaining stations we have determined that keeping them at a minimum of 20% of capacity should be enough to fulfill demand. It is important to note this is an assumption we are making to set the constraints of the model in terms of the available resources, not an optimal recommendation for the minimum capacity for stations."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5daa3690",
   "metadata": {},
   "source": [
    "## Assumptions and Limitations"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "73a8ee7f",
   "metadata": {},
   "source": [
    "For the transport costs and services, we are assuming the reposition services work 24h a day – 7 days a week, so the model isn’t limited to hours of service since bikes can be taken out and in at any time. Additionally, we are assuming they can adjust to any recommended schedule. In terms of expenses, we don’t have the fix or variable costs, so we have considered all repositioning actions have an equal cost despite the distance between stations, to focus on minimizing on the total number of transports. \n",
    "Regarding the data available, we have considered the total bikes’ ids in the Divvy_trips_2017 Q3 and Q4 datasets as the total bikes available in the company, to set a constraint for limited resources. Similarly, all stations in the divvy_stations_2017 dataset as the total number of stations the firm manages. Furthermore, since we are using the averages to find the number of bikes taken in and out of the station, we are assuming the historical trips data provided (Divvy_trips_2017_Q3 and Divvy_trips_2017_Q4) is normally distributed, an accurate representation of customer behavior and that there are no seasonality or intra-weekly variances, to establish an optimal schedule that applies everyday of the year."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "77e8cb17",
   "metadata": {},
   "source": [
    "# MODEL OVERVIEW"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8fef144b",
   "metadata": {},
   "source": [
    "Outline of Parameters, Variables and Constraints"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5b4d2e9f",
   "metadata": {},
   "source": [
    "## Parameters\n",
    "For the parameters of the model, we have defined the following four based on the capacity of stations, bikes available and points (stations) of transport:\n",
    "\n",
    "- $C_{i}$ as the capacity of station $i$ \n",
    "- $D_{i,j}$ as the distance from station $i$ to station $j$\n",
    "- $A$ as the total available bikes in Divvy, considering the amount reserved for the stations not considered in the study\n",
    "- $U_{i,j,t}$ as the number of bikes transported from station $i$ to station $j$ by users in time period $t$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "933cd90f",
   "metadata": {},
   "source": [
    "## Variables\n",
    "Regarding the variables, we have defined the following: \n",
    "- $X_{i,j,t}$ as the decision of moving $X_{i,j,t}$ amount of bikes from station $i$ to the station $j$ in time period $t$\n",
    "- $B_{i,t}$ as the amount of bikes at station $i$ in time period $t$\n",
    "where\\\n",
    "$i \\in I,$ $I$ is the set of 5 busiest stations \\\n",
    "$j \\in J,$ $J$ is the set of 5 busiest stations  \\\n",
    "$t \\in T$ = [morning, afternoon]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6d4d5ad2",
   "metadata": {},
   "source": [
    "## Constraints\n",
    "We have defined two types of constraints, compulsory and managerial. The first one being all mandatory constrains that account for the limited resources of the company, such as the bikes and stations. The second ones to consider the out-of-the-norm behaviour that can be exhibit by non-regular customers, who have no consistent behaviour that can be mapped out and included in the model. \n",
    "As mentioned before, we have analyzed the top 5 busiest origin and destination stations to provide an optimal capacity on two timeframes: morning and night. To achieve this, we have performed a count of the trips throughout both quarters on all the stations ids, sorted them on descending order and taking the top 5 ids."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bc319ad6",
   "metadata": {},
   "source": [
    "### Compulsory constraints"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "efb79ef2",
   "metadata": {},
   "source": [
    "1) The number of bikes across all stations at any time must not exceed the available number of bikes Divvy has,  $$\\sum_{i\\in I} B_{i,t} \\le A $$ \n",
    "2) The number of bikes at a station should fit within the available capacity, $$B_{i,t} \\le C_{i} $$ \n",
    "3) The number of bikes to be repositioned from station $i$ to station $j$ in time period $t$ must not be more than the number of bikes station $i$ currently has in time period $t$, $$B_{i,t} = B_{i,t-1} + \\sum_{j\\in J} X_{j,i,t} + \\sum_{j\\in J} U_{j,i,t} - \\sum_{j\\in J} X_{i,j,t} - \\sum_{j\\in J} U_{i,j,t}$$\n",
    "4) $X_{i,j,t}$ and $B_{i,t}$ must be positive integers"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1083ce17",
   "metadata": {},
   "source": [
    "### Business constraints\n",
    "1) To account for unpredictable behavior, all stations at any given time should have at least the historical number of bikes picked up from that station in the next time period $t+1$  , $$B_{i,t} \\ge \\sum_{j\\in J} U_{i,j,t+1}$$\n",
    "2) To account for unpredictable behavior, all stations at time $t$ should have at most the difference between that station's capacity and the historical number of bikes dropped off at that station in the next time period $t+1$, $$B_{i,t} \\le C_{i} - \\sum_{j\\in J} U_{j,i,t+1}$$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "525880bf",
   "metadata": {},
   "source": [
    "### Objective function"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2de6d086",
   "metadata": {},
   "source": [
    "Our objective function is to minimize the cost of repositioning operation, which is to minimize the total number of trips of repositioning operation from all station $i$ to all station $j$ in all time period $t$. Therefore, we minimize $$\\sum_{i \\in I}\\sum_{j\\in J}\\sum_{t \\in T} X_{i,j,t}.D_{i,j}$$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c3c5036d",
   "metadata": {},
   "source": [
    "# DATA EXTRACTION FOR THE PARAMETERS"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "22a20fdd",
   "metadata": {},
   "source": [
    "In order to set the parameters, the following data extraction and definition has been performed."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "88004277",
   "metadata": {},
   "source": [
    "### $C_{i}$ : the capacity of station $i$ "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "43fda5c6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>id</th> <th>dpcapacity</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>35  </td> <td>47        </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>76  </td> <td>39        </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>177 </td> <td>23        </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>192 </td> <td>47        </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>268 </td> <td>39        </td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "id   | dpcapacity\n",
       "35   | 47\n",
       "76   | 39\n",
       "177  | 23\n",
       "192  | 47\n",
       "268  | 39"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "C = busiest_origin_stations.take(np.arange(5)).join('id', stations, 'id').select('id', 'dpcapacity')\n",
    "C"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c8c89357",
   "metadata": {},
   "source": [
    "### $D_{i,j}$: the distance from station $𝑖$ to station $𝑗$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "a07e3c95",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>id</th> <th>35</th> <th>192</th> <th>76</th> <th>177</th> <th>268</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>35  </td> <td>0      </td> <td>2.72757</td> <td>1.31645</td> <td>4.08549</td> <td>2.48282</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>192 </td> <td>2.72757</td> <td>0      </td> <td>1.93179</td> <td>5.27674</td> <td>3.76645</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>76  </td> <td>1.31645</td> <td>1.93179</td> <td>0      </td> <td>5.16765</td> <td>3.51752</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>177 </td> <td>4.08549</td> <td>5.27674</td> <td>5.16765</td> <td>0      </td> <td>1.65085</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>268 </td> <td>2.48282</td> <td>3.76645</td> <td>3.51752</td> <td>1.65085</td> <td>0      </td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "busiest_stations_coords = busiest_origin_stations.take(np.arange(5)).join('id', stations, 'id').sort('count', descending = True).select('id', 'latitude', 'longitude')\n",
    "D = Table().with_column('id', busiest_origin_stations.take(np.arange(5)).column('id'))\n",
    "def find_distance(station):\n",
    "    global D\n",
    "    lat = busiest_stations_coords.where('id', station).column('latitude')[0]\n",
    "    long = busiest_stations_coords.where('id', station).column('longitude')[0]\n",
    "    this_station_coords = (lat, long)\n",
    "    station_ids = busiest_stations_coords.column('id')\n",
    "    station_distance = np.zeros(len(station_ids))\n",
    "    for i in np.arange(len(station_ids)):\n",
    "        other_station_coords = (busiest_stations_coords.where('id', station_ids[i]).column('latitude')[0],\n",
    "                                busiest_stations_coords.where('id', station_ids[i]).column('longitude')[0])\n",
    "        station_distance[i] = geopy.distance.geodesic(this_station_coords, other_station_coords).km\n",
    "        D = D.with_column(str(station),station_distance)    \n",
    "busiest_stations_coords.apply(find_distance, 'id')\n",
    "D.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "5cb7fc00",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th> </th> <th>stat</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>mean  </td> <td>3.19233</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>median</td> <td>3.12254</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>max   </td> <td>5.27674</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>min   </td> <td>1.31645</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "       | stat\n",
       "mean   | 3.19233\n",
       "median | 3.12254\n",
       "max    | 5.27674\n",
       "min    | 1.31645"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# statistics of the distance between stations\n",
    "i = 1\n",
    "k = 0\n",
    "j = 1\n",
    "all_dist = np.zeros(sum(np.arange(D.num_rows)))\n",
    "for i in np.arange(i, D.num_rows):\n",
    "    j = i\n",
    "    for j in np.arange(j, D.num_rows):\n",
    "        all_dist[k] = D[i][j] \n",
    "        k = k + 1\n",
    "mean_dist = np.mean(all_dist)\n",
    "all_dist\n",
    "dist_summary = Table().with_columns(' ', ['mean', 'median', 'max', 'min'], \n",
    "                                 'stat', [np.mean(all_dist), np.median(all_dist), np.max(all_dist), np.min(all_dist)])\n",
    "dist_summary"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "578237f1",
   "metadata": {},
   "source": [
    "### $U_{i,j,t}$: the number of bikes transported from station $i$ to all stations $j$ by users in time period $t$ (registered in the from_station_id variable)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "aca66ee6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>time</th> <th>35</th> <th>192</th> <th>76</th> <th>177</th> <th>268</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>morning</td> <td>59.0339</td> <td>94.5355</td> <td>38.4512</td> <td>35.1796</td> <td>29.1193</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>night  </td> <td>275.607</td> <td>84.2717</td> <td>142.78 </td> <td>138.145</td> <td>140.791</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "time    | 35      | 192     | 76      | 177     | 268\n",
       "morning | 59.0339 | 94.5355 | 38.4512 | 35.1796 | 29.1193\n",
       "night   | 275.607 | 84.2717 | 142.78  | 138.145 | 140.791"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "busiest_origin_stations_traffic = Table().with_columns('id', busiest_origin_stations.take(np.arange(5)).column('id')).join('id', trips.select('from_station_id', 'start_time'), 'from_station_id')\n",
    "date_array = [\"\" for i in range(busiest_origin_stations_traffic.num_rows)]\n",
    "time_array = [\"\" for i in range(busiest_origin_stations_traffic.num_rows)]\n",
    "for i in np.arange(busiest_origin_stations_traffic.num_rows):\n",
    "    date_array[i] = busiest_origin_stations_traffic.column('start_time')[i].split(' ')[0]\n",
    "    if (0 <= int(busiest_origin_stations_traffic.column('start_time')[i].split(' ')[1].split(':')[0]) <= 11):\n",
    "        time_array[i] = 'morning'\n",
    "    else:\n",
    "        time_array[i] = 'night'\n",
    "busiest_origin_stations_traffic = busiest_origin_stations_traffic.with_columns('date', date_array, 'time', time_array).group(['id','date', 'time'])\n",
    "U_ijt = Table().with_column('time', ['morning', 'night'])\n",
    "traffic_count = np.zeros(len(U_ijt.column('time')))\n",
    "def avg_traffic(id):\n",
    "    global U_ijt\n",
    "    for i in np.arange(len(U_ijt.column('time'))):\n",
    "        count = busiest_origin_stations_traffic.where('id', id).where('time', U_ijt[0][i]).column('count')\n",
    "        traffic_count[i] = sum(count)/len(count)\n",
    "    U_ijt = U_ijt.with_column(str(id), [traffic_count[0], traffic_count[1]])\n",
    "for i in np.arange(busiest_origin_stations.take(np.arange(5)).num_rows):\n",
    "    avg_traffic(busiest_origin_stations.take(np.arange(5)).column('id')[i])\n",
    "U_ijt"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "58d9609f",
   "metadata": {},
   "source": [
    "### $U_{j,i,t}$: the number of bikes transported to station $i$ from all stations $j$ by users in time period $t$ (registered in the to_station_id variable)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "f3703d1e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>time</th> <th>35</th> <th>192</th> <th>268</th> <th>177</th> <th>76</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>morning</td> <td>83.5495</td> <td>50.2951</td> <td>38.5439</td> <td>46.3114</td> <td>40.9497</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>night  </td> <td>280.219</td> <td>142.366</td> <td>152.08 </td> <td>137.742</td> <td>130.375</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "time    | 35      | 192     | 268     | 177     | 76\n",
       "morning | 83.5495 | 50.2951 | 38.5439 | 46.3114 | 40.9497\n",
       "night   | 280.219 | 142.366 | 152.08  | 137.742 | 130.375"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "busiest_dest_stations_traffic = Table().with_columns('id', busiest_dest_stations.take(np.arange(5)).column('id')).join('id', trips.select('to_station_id', 'start_time'), 'to_station_id')\n",
    "date_array = [\"\" for i in range(busiest_dest_stations_traffic.num_rows)]\n",
    "time_array = [\"\" for i in range(busiest_dest_stations_traffic.num_rows)]\n",
    "for i in np.arange(busiest_dest_stations_traffic.num_rows):\n",
    "    date_array[i] = busiest_dest_stations_traffic.column('start_time')[i].split(' ')[0]\n",
    "    if (0 <= int(busiest_dest_stations_traffic.column('start_time')[i].split(' ')[1].split(':')[0]) <= 11):\n",
    "        time_array[i] = 'morning'\n",
    "    else:\n",
    "        time_array[i] = 'night'\n",
    "busiest_dest_stations_traffic = busiest_dest_stations_traffic.with_columns('date', date_array, 'time', time_array).group(['id','date', 'time'])\n",
    "busiest_dest_stations_traffic\n",
    "U_jit = Table().with_column('time', ['morning', 'night'])\n",
    "traffic_count = np.zeros(len(U_jit.column('time')))\n",
    "def avg_traffic(id):\n",
    "    global U_jit \n",
    "    for i in np.arange(len(U_jit .column('time'))):\n",
    "        count = busiest_dest_stations_traffic.where('id', id).where('time', U_jit[0][i]).column('count')\n",
    "        traffic_count[i] = sum(count)/len(count)\n",
    "    U_jit = U_jit .with_column(str(id), [traffic_count[0], traffic_count[1]])\n",
    "for i in np.arange(busiest_dest_stations.take(np.arange(5)).num_rows):\n",
    "    avg_traffic(busiest_dest_stations.take(np.arange(5)).column('id')[i])\n",
    "U_jit"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c85288c4",
   "metadata": {},
   "source": [
    "### $A$: number of unique bikes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "831c29aa",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "49526.0"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# A is the number of bikes available for each time period (morning & night, 12 hours each)\n",
    "A = len(np.unique(trips.column('bikeid')))*12 \n",
    "\n",
    "# Set the a fixed number of bikes for all the stations that are not included in the model (20%)\n",
    "array = stations.column('dpcapacity')*12*0.2 \n",
    "\n",
    "fixed_num_of_bikes = Table().with_columns('id', stations.column('id'),\n",
    "                                             'fixed number of bikes', [int(x) for x in array])\n",
    "five_busiest_stations = np.zeros(5)\n",
    "\n",
    "# extracting the set number of bikes for 5 busiest stations\n",
    "for i in np.arange(5):\n",
    "    five_busiest_stations[i] = fixed_num_of_bikes.where('id', are.equal_to(busiest_origin_stations.take(np.arange(5)).column('id')[i])).column('fixed number of bikes')[0]\n",
    "\n",
    "# A equals to the total amount of unique bikes minus the total number of bikes set for all stations \n",
    "# plus the fixed amount of bikes set for 5 busiest stations\n",
    "A = A - sum(fixed_num_of_bikes.column('fixed number of bikes')) + sum(five_busiest_stations) \n",
    "A"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "46d2ba72",
   "metadata": {},
   "source": [
    "# RUNNING GUROBI MODEL OPTIMIZATION"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1a36dfa5",
   "metadata": {},
   "source": [
    "Next, we will set the variables and constraints for the model based on the paramenters mentioned in the section above."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5a9970a7",
   "metadata": {},
   "source": [
    "## Variables"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "efe971a4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Restricted license - for non-production use only - expires 2023-10-25\n"
     ]
    }
   ],
   "source": [
    "# initialize the model\n",
    "M = Model()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "25c51462",
   "metadata": {},
   "outputs": [],
   "source": [
    "# create a dictionary of variables\n",
    "S = busiest_origin_stations.take(np.arange(5)).column('id')\n",
    "T = ['morning', 'night']\n",
    "\n",
    "B = {} # optimal number of bikes at a station \n",
    "X = {} # optimal number of bikes to be repositioned\n",
    "B = M.addVars(S,T)\n",
    "X = M.addVars([(i,j,t) for i in S for j in S if i!=j for t in T])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8c262507",
   "metadata": {},
   "source": [
    "## Constraints"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5fd8cbb9",
   "metadata": {},
   "source": [
    "### Compulsory constraints"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6f143c19",
   "metadata": {},
   "source": [
    "1) The number of bikes across all stations at any time must not exceed the available number of bikes Divvy has,  $$\\sum_{i\\in I} B_{i,t} \\le A $$ "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "4097c64a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'morning': <gurobi.Constr *Awaiting Model Update*>,\n",
       " 'night': <gurobi.Constr *Awaiting Model Update*>}"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "M.addConstrs(quicksum(B[i,t] for i in S) <= A for t in T)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b6252598",
   "metadata": {},
   "source": [
    "2) The number of bikes at a station should fit within the available capacity, $$B_{i,t} \\le C_{i} $$ "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "6f65c48f",
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in S:\n",
    "    capacity = int(C.where('id', i).column('dpcapacity')[0])\n",
    "    for t in T:\n",
    "        M.addConstr(B[i,t] <= capacity*12)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2d5ed3f1",
   "metadata": {},
   "source": [
    "3) The number of bikes to be repositioned from station $i$ to station $j$ in time period $t$ must not be more than the number of bikes station $i$ currently has in time period $t$, $$B_{i,t} = B_{i,t-1} + \\sum_{j\\in J} X_{j,i,t} + \\sum_{j\\in J} U_{j,i,t} - \\sum_{j\\in J} X_{i,j,t} - \\sum_{j\\in J} U_{i,j,t}$$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "41a2af1b",
   "metadata": {},
   "outputs": [],
   "source": [
    "for t in T:\n",
    "    if (t == \"morning\"):\n",
    "        t_minusone = \"night\"\n",
    "        for i in S:\n",
    "            M.addConstr(B[i,t] == B[i,t_minusone] + quicksum(X[j,i,t] for j in S if i!=j) + U_jit.column(str(i))[0] - quicksum(X[i,j,t] for j in S if i!=j) - U_ijt.column(str(i))[0])\n",
    "    else:\n",
    "        t_minusone = \"morning\"\n",
    "        for i in S:\n",
    "            M.addConstr(B[i,t] == B[i,t_minusone] + quicksum(X[j,i,t] for j in S if i!=j) + U_jit.column(str(i))[1] - quicksum(X[i,j,t] for j in S if i!=j) - U_ijt.column(str(i))[1])\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "07136457",
   "metadata": {},
   "source": [
    "4) $X_{i,j,t}$ and $B_{i,t}$ must be positive integers\\\n",
    "In our business constraints below, we are setting the minimum number of bikes at a station ($B_{i,t}$) to be bigger or equal to the historical number of bikes picked up from that station, which obviously will be a positive number. Therefore, we only need to add the constraint that our decision variable $X_{i,j,t}$ is positive "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "69732209",
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in S:\n",
    "    for t in T:\n",
    "        for j in S:\n",
    "            if (i != j):\n",
    "                M.addConstr(X[i,j,t] >= 0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d3b550af",
   "metadata": {},
   "source": [
    "### Business constraints"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2f2e4016",
   "metadata": {},
   "source": [
    "1) To account for unpredictable behavior, all stations at any given time should have at least the historical number of bikes picked up from that station in the next time period $t+1$  , $$B_{i,t} \\ge \\sum_{j\\in J} U_{i,j,t+1}$$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "4fbbc107",
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in S:\n",
    "    for t in T:\n",
    "        if (t == 'morning'):\n",
    "            M.addConstr(B[i,t] >= U_ijt.column(str(i))[1]) # if t is morning, t+1 will be night\n",
    "        else:\n",
    "            M.addConstr(B[i,t] >= U_ijt.column(str(i))[0]) # if t is night, t+1 will be morning"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "972e7618",
   "metadata": {},
   "source": [
    "2) To account for unpredictable behavior, all stations at time $t$ should have a maximum of slots available equal to the difference between that station's capacity and the historical number of bikes dropped off at that station in the next time period $t+1$, $$B_{i,t} \\le C_{i} - \\sum_{j\\in J} U_{j,i,t+1}$$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "a99d420a",
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in S:\n",
    "    capacity = int(C.where('id', i).column('dpcapacity')[0])\n",
    "    for t in T:\n",
    "        if (t == 'morning'):\n",
    "            M.addConstr(B[i,t] <= capacity*12 - U_jit.column(str(i))[1]) # if t is morning, t+1 will be night\n",
    "        else:\n",
    "            M.addConstr(B[i,t] <= capacity*12 - U_jit.column(str(i))[0]) # if t is night, t+1 will be morning"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b4dcec3a",
   "metadata": {},
   "source": [
    "## Optimization"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7609ef49",
   "metadata": {},
   "source": [
    "The model takes into account the previously mentioned constraints and parameters to provide an optimal capacity fulfilment and empty slots per timeframe (morning/night).\n",
    "However, after running the model and relaxing the business assumptions, an optimal logistic scheme was unfeasible with the current (limited) resources and constraints. Please note we included an automatic flexibility of the assumptions for the model, as the current required constraints limit our ability to provide a schedule recommendation."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "3756c324",
   "metadata": {},
   "outputs": [],
   "source": [
    "z = quicksum(X[j,i,t]*D.where(\"id\", i).column(str(j))[0] for t in T for i in S for j in S if i!=j)\n",
    "M.setObjective(z, GRB.MINIMIZE)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "9d64bb95",
   "metadata": {},
   "outputs": [],
   "source": [
    "M.update()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "a991021c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Minimize\n",
      "<gurobi.LinExpr: 2.7275680340704915 C10 + 2.7275680340704915 C11\n",
      "+ 1.3164477825107272 C12 + 1.3164477825107272 C13 + 4.085493818947044 C14\n",
      "+ 4.085493818947044 C15 + 2.4828215756003513 C16 + 2.4828215756003513 C17\n",
      "+ 2.7275680340704915 C18 + 2.7275680340704915 C19 + 1.9317872604973294 C20\n",
      "+ 1.9317872604973294 C21 + 5.276744910651863 C22 + 5.276744910651863 C23\n",
      "+ 3.766450417517531 C24 + 3.766450417517531 C25 + 1.3164477825107272 C26\n",
      "+ 1.3164477825107272 C27 + 1.9317872604973294 C28 + 1.9317872604973294 C29\n",
      "+ 5.167652997782674 C30 + 5.167652997782674 C31 + 3.5175197666111884 C32\n",
      "+ 3.5175197666111884 C33 + 4.085493818947044 C34 + 4.085493818947044 C35\n",
      "+ 5.276744910651863 C36 + 5.276744910651863 C37 + 5.167652997782674 C38\n",
      "+ 5.167652997782674 C39 + 1.6508535620486084 C40 + 1.6508535620486084 C41\n",
      "+ 2.4828215756003513 C42 + 2.4828215756003513 C43 + 3.766450417517531 C44\n",
      "+ 3.766450417517531 C45 + 3.5175197666111884 C46 + 3.5175197666111884 C47\n",
      "+ 1.6508535620486084 C48 + 1.6508535620486084 C49>\n",
      "Subject To\n",
      "  R0: <gurobi.LinExpr: C0 + C2 + C4 + C6 + C8> <= 49526\n",
      "  R1: <gurobi.LinExpr: C1 + C3 + C5 + C7 + C9> <= 49526\n",
      "  R2: <gurobi.LinExpr: C0> <= 564\n",
      "  R3: <gurobi.LinExpr: C1> <= 564\n",
      "  R4: <gurobi.LinExpr: C2> <= 564\n",
      "  R5: <gurobi.LinExpr: C3> <= 564\n",
      "  R6: <gurobi.LinExpr: C4> <= 468\n",
      "  R7: <gurobi.LinExpr: C5> <= 468\n",
      "  R8: <gurobi.LinExpr: C6> <= 276\n",
      "  R9: <gurobi.LinExpr: C7> <= 276\n",
      "  R10: <gurobi.LinExpr: C8> <= 468\n",
      "  R11: <gurobi.LinExpr: C9> <= 468\n",
      "R12: <gurobi.LinExpr: C0 + -1.0 C1 + C10 + C12 + C14 + C16 + -1.0 C18 + -1.0 C26 + -1.0\n",
      " C34 + -1.0 C42> = 24.5156\n",
      "R13: <gurobi.LinExpr: C2 + -1.0 C3 + -1.0 C10 + C18 + C20 + C22 + C24 + -1.0 C28 + -1.0\n",
      " C36 + -1.0 C44> = -44.2404\n",
      "R14: <gurobi.LinExpr: C4 + -1.0 C5 + -1.0 C12 + -1.0 C20 + C26 + C28 + C30 + C32 + -1.0\n",
      " C38 + -1.0 C46> = 2.49847\n",
      "R15: <gurobi.LinExpr: C6 + -1.0 C7 + -1.0 C14 + -1.0 C22 + -1.0 C30 + C34 + C36 + C38 +\n",
      " C40 + -1.0 C48> = 11.1317\n",
      "R16: <gurobi.LinExpr: C8 + -1.0 C9 + -1.0 C16 + -1.0 C24 + -1.0 C32 + -1.0 C40 + C42 +\n",
      " C44 + C46 + C48> = 9.42454\n",
      "R17: <gurobi.LinExpr: -1.0 C0 + C1 + C11 + C13 + C15 + C17 + -1.0 C19 + -1.0 C27 + -1.0\n",
      " C35 + -1.0 C43> = 4.61202\n",
      "R18: <gurobi.LinExpr: -1.0 C2 + C3 + -1.0 C11 + C19 + C21 + C23 + C25 + -1.0 C29 + -1.0\n",
      " C37 + -1.0 C45> = 58.0944\n",
      "R19: <gurobi.LinExpr: -1.0 C4 + C5 + -1.0 C13 + -1.0 C21 + C27 + C29 + C31 + C33 + -1.0\n",
      " C39 + -1.0 C47> = -12.4047\n",
      "R20: <gurobi.LinExpr: -1.0 C6 + C7 + -1.0 C15 + -1.0 C23 + -1.0 C31 + C35 + C37 + C39 +\n",
      " C41 + -1.0 C49> = -0.403678\n",
      "R21: <gurobi.LinExpr: -1.0 C8 + C9 + -1.0 C17 + -1.0 C25 + -1.0 C33 + -1.0 C41 + C43 +\n",
      " C45 + C47 + C49> = 11.2886\n",
      "  R22: <gurobi.LinExpr: C10> >= 0\n",
      "  R23: <gurobi.LinExpr: C12> >= 0\n",
      "  R24: <gurobi.LinExpr: C14> >= 0\n",
      "  R25: <gurobi.LinExpr: C16> >= 0\n",
      "  R26: <gurobi.LinExpr: C11> >= 0\n",
      "  R27: <gurobi.LinExpr: C13> >= 0\n",
      "  R28: <gurobi.LinExpr: C15> >= 0\n",
      "  R29: <gurobi.LinExpr: C17> >= 0\n",
      "  R30: <gurobi.LinExpr: C18> >= 0\n",
      "  R31: <gurobi.LinExpr: C20> >= 0\n",
      "  R32: <gurobi.LinExpr: C22> >= 0\n",
      "  R33: <gurobi.LinExpr: C24> >= 0\n",
      "  R34: <gurobi.LinExpr: C19> >= 0\n",
      "  R35: <gurobi.LinExpr: C21> >= 0\n",
      "  R36: <gurobi.LinExpr: C23> >= 0\n",
      "  R37: <gurobi.LinExpr: C25> >= 0\n",
      "  R38: <gurobi.LinExpr: C26> >= 0\n",
      "  R39: <gurobi.LinExpr: C28> >= 0\n",
      "  R40: <gurobi.LinExpr: C30> >= 0\n",
      "  R41: <gurobi.LinExpr: C32> >= 0\n",
      "  R42: <gurobi.LinExpr: C27> >= 0\n",
      "  R43: <gurobi.LinExpr: C29> >= 0\n",
      "  R44: <gurobi.LinExpr: C31> >= 0\n",
      "  R45: <gurobi.LinExpr: C33> >= 0\n",
      "  R46: <gurobi.LinExpr: C34> >= 0\n",
      "  R47: <gurobi.LinExpr: C36> >= 0\n",
      "  R48: <gurobi.LinExpr: C38> >= 0\n",
      "  R49: <gurobi.LinExpr: C40> >= 0\n",
      "  R50: <gurobi.LinExpr: C35> >= 0\n",
      "  R51: <gurobi.LinExpr: C37> >= 0\n",
      "  R52: <gurobi.LinExpr: C39> >= 0\n",
      "  R53: <gurobi.LinExpr: C41> >= 0\n",
      "  R54: <gurobi.LinExpr: C42> >= 0\n",
      "  R55: <gurobi.LinExpr: C44> >= 0\n",
      "  R56: <gurobi.LinExpr: C46> >= 0\n",
      "  R57: <gurobi.LinExpr: C48> >= 0\n",
      "  R58: <gurobi.LinExpr: C43> >= 0\n",
      "  R59: <gurobi.LinExpr: C45> >= 0\n",
      "  R60: <gurobi.LinExpr: C47> >= 0\n",
      "  R61: <gurobi.LinExpr: C49> >= 0\n",
      "  R62: <gurobi.LinExpr: C0> >= 275.607\n",
      "  R63: <gurobi.LinExpr: C1> >= 59.0339\n",
      "  R64: <gurobi.LinExpr: C2> >= 84.2717\n",
      "  R65: <gurobi.LinExpr: C3> >= 94.5355\n",
      "  R66: <gurobi.LinExpr: C4> >= 142.78\n",
      "  R67: <gurobi.LinExpr: C5> >= 38.4512\n",
      "  R68: <gurobi.LinExpr: C6> >= 138.145\n",
      "  R69: <gurobi.LinExpr: C7> >= 35.1796\n",
      "  R70: <gurobi.LinExpr: C8> >= 140.791\n",
      "  R71: <gurobi.LinExpr: C9> >= 29.1193\n",
      "  R72: <gurobi.LinExpr: C0> <= 283.781\n",
      "  R73: <gurobi.LinExpr: C1> <= 480.451\n",
      "  R74: <gurobi.LinExpr: C2> <= 421.634\n",
      "  R75: <gurobi.LinExpr: C3> <= 513.705\n",
      "  R76: <gurobi.LinExpr: C4> <= 337.625\n",
      "  R77: <gurobi.LinExpr: C5> <= 427.05\n",
      "  R78: <gurobi.LinExpr: C6> <= 138.258\n",
      "  R79: <gurobi.LinExpr: C7> <= 229.689\n",
      "  R80: <gurobi.LinExpr: C8> <= 315.92\n",
      "  R81: <gurobi.LinExpr: C9> <= 429.456\n",
      "None\n"
     ]
    }
   ],
   "source": [
    "print(M.display())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "2c8b44fb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (mac64[x86])\n",
      "Thread count: 4 physical cores, 8 logical processors, using up to 8 threads\n",
      "Optimize a model with 82 rows, 50 columns and 180 nonzeros\n",
      "Model fingerprint: 0xa8d96b70\n",
      "Coefficient statistics:\n",
      "  Matrix range     [1e+00, 1e+00]\n",
      "  Objective range  [1e+00, 5e+00]\n",
      "  Bounds range     [0e+00, 0e+00]\n",
      "  RHS range        [4e-01, 5e+04]\n",
      "Presolve removed 72 rows and 5 columns\n",
      "Presolve time: 0.01s\n",
      "\n",
      "Solved in 0 iterations and 0.01 seconds (0.00 work units)\n",
      "Infeasible model\n"
     ]
    }
   ],
   "source": [
    "M.optimize()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "e54dc180",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Iteration    Objective       Primal Inf.    Dual Inf.      Time\n",
      "       0    0.0000000e+00   1.216528e+03   0.000000e+00      0s\n",
      "\n",
      "IIS computed: 10 constraints and 0 bounds\n",
      "IIS runtime: 0.01 seconds (0.00 work units)\n"
     ]
    }
   ],
   "source": [
    "# This function helps us detect the source of infeasibility in our model, \n",
    "# and it seems that our 3rd constraint is what causes the model to be infeasible\n",
    "M.computeIIS() \n",
    "M.write(\"model.ilp\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c2e5a63e",
   "metadata": {},
   "source": [
    "Since our model is infeasible, we decide to call the feasRelaxS() function on our model M, which modifies our model to create a feasibility relaxation, while minimizing the amount by which the solution violates the bounds and linear constraints of the original model."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "09d4badf",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (mac64[x86])\n",
      "Thread count: 4 physical cores, 8 logical processors, using up to 8 threads\n",
      "Optimize a model with 132 rows, 192 columns and 372 nonzeros\n",
      "Coefficient statistics:\n",
      "  Matrix range     [1e+00, 1e+00]\n",
      "  Objective range  [1e+00, 1e+00]\n",
      "  Bounds range     [0e+00, 0e+00]\n",
      "  RHS range        [4e-01, 5e+04]\n",
      "Iteration    Objective       Primal Inf.    Dual Inf.      Time\n",
      "       0      handle free variables                          0s\n",
      "      38    6.4516508e+01   0.000000e+00   0.000000e+00      0s\n",
      "\n",
      "Solved in 38 iterations and 0.01 seconds (0.00 work units)\n",
      "Optimal objective  6.451650767e+01\n"
     ]
    }
   ],
   "source": [
    "M.feasRelaxS(0, False, True, True)\n",
    "M.optimize()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "ab37fbeb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Optimal value of the objective function is:  64.51650767128933\n"
     ]
    }
   ],
   "source": [
    "print(\"Optimal value of the objective function is: \",M.objVal)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "d3bc02a1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The number bikes at station (35, 'morning') is: 276\n",
      "The number bikes at station (35, 'night') is: 241\n",
      "The number bikes at station (192, 'morning') is: 85\n",
      "The number bikes at station (192, 'night') is: 129\n",
      "The number bikes at station (76, 'morning') is: 143\n",
      "The number bikes at station (76, 'night') is: 120\n",
      "The number bikes at station (177, 'morning') is: 139\n",
      "The number bikes at station (177, 'night') is: 138\n",
      "The number bikes at station (268, 'morning') is: 141\n",
      "The number bikes at station (268, 'night') is: 153\n"
     ]
    }
   ],
   "source": [
    "for i in B:\n",
    "    # rounding up the number of bikes because they have to be integers\n",
    "    print(\"The number bikes at station\", i, \"is:\", math.ceil(B[i].X)) "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2726d286",
   "metadata": {},
   "source": [
    "\n",
    "| Time    |35 |192|76 |177|268|\n",
    "|:--------|---|---|---|---|---|\n",
    "|Morning  |276|85|143|139|141|\n",
    "|Night    |241|129 |120 |138 |153 |"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "fbbf15e1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The number bikes of to be repositioned  (35, 76, 'night') is: 40\n",
      "The number bikes of to be repositioned  (192, 76, 'night') is: 14\n",
      "The number bikes of to be repositioned  (177, 35, 'morning') is: 11\n",
      "The number bikes of to be repositioned  (268, 76, 'morning') is: 21\n"
     ]
    }
   ],
   "source": [
    "for i in X:\n",
    "    if (X[i].X != 0):\n",
    "        # rounding up the number of bikes because they have to be integers\n",
    "        print(\"The number bikes of to be repositioned \", i, \"is:\", math.ceil(X[i].X))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8893ddae",
   "metadata": {},
   "source": [
    "As we can see from the results above, this is the suggested logistic scheme of bikes to transport between the top 5 stations. The interpretation of the results is as follows:\n",
    "Throughout the morning of any given day, the required number of bikes to be reposition from station 177 to station 35 is 11, the required number of bikes to be reposition from station 268 to station 76 is 21. Throughout the night of any given day, the required number of bikes to be reposition from station 35 to station 76 is 40, and the required number of bikes to be reposition from station 192 to station 76 is 14"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "48ab36b7",
   "metadata": {},
   "source": [
    "## SENSITIVITY ANALYSIS"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7fa03dbb",
   "metadata": {},
   "source": [
    "Regarding the sensitivity and managerial analysis of the model, we are proposing two scenarios to conduct further analysis in: the change in the time sections considered and change in the minimal number of transports with less bikes. We are focusing on variability in a resource the company can control (total number of bikes), and with further data on operational costs and revenue, how this insight might lead to a revaluation on the optimal number of bikes to manage."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ebde13cf",
   "metadata": {},
   "source": [
    "#### 1) Changing the constraint for unlimited resources will showcase the absolute minimum transports. After setting the new constraints, we find that the number of transports doesn’t decrease, it actually remains stable even if we decrease the number of available bikes by ~600."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "0fc01db1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "  Constraint        Sense        Slack           Pi          RHS     SARHSLow      SARHSUp \n",
      "------------------------------------------------------------------------------------------\n",
      "          R0            <      48744.4            0        49526      781.594          inf \n",
      "          R1            <      48747.7            0        49526      778.264          inf \n",
      "          R2            <      288.393            0          564      275.607          inf \n",
      "          R3            <      323.637            0          564      240.363          inf \n",
      "          R4            <      479.728            0          564      84.2717          inf \n",
      "          R5            <      435.488            0          564      128.512          inf \n",
      "          R6            <       325.22            0          468       142.78          inf \n",
      "          R7            <      348.432            0          468      119.568          inf \n",
      "          R8            <      137.855            0          276      138.145          inf \n",
      "          R9            <      138.258            0          276      137.742          inf \n",
      "         R10            <      327.209            0          468      140.791          inf \n",
      "         R11            <       315.92            0          468       152.08          inf \n",
      "         R12            =            0            1      24.5156     -15.3401      205.845 \n",
      "         R13            =            0            1     -44.2404     -58.0944     -10.2638 \n",
      "         R14            =            0            1      2.49847      -62.018      83.6153 \n",
      "         R15            =            0            1      11.1317     0.403678      192.461 \n",
      "         R16            =            0            1      9.42454     -11.2886      90.5414 \n",
      "         R17            =            0            1      4.61202     -35.2436          inf \n",
      "         R18            =            0            1      58.0944      44.2404          inf \n",
      "         R19            =            0            1     -12.4047     -76.9212          inf \n",
      "         R20            =            0            1    -0.403678     -11.1317      91.5434 \n",
      "         R21            =            0            1      11.2886     -9.42454      92.4054 \n",
      "         R22            >            0            0            0            0      33.9767 \n",
      "         R23            >            0            0            0            0      39.8556 \n",
      "         R24            >            0            0            0            0          inf \n",
      "         R25            >            0            0            0            0      39.8556 \n",
      "         R26            >            0            0            0            0      39.8556 \n",
      "         R27            >     -39.8556            0            0         -inf      39.8556 \n",
      "         R28            >            0            0            0            0       91.947 \n",
      "         R29            >            0            0            0            0      39.8556 \n",
      "         R30            >            0            0            0            0      13.8539 \n",
      "         R31            >            0            0            0            0      13.8539 \n",
      "         R32            >            0            0            0            0      13.8539 \n",
      "         R33            >            0            0            0            0      13.8539 \n",
      "         R34            >            0            0            0            0      13.8539 \n",
      "         R35            >     -13.8539            0            0         -inf      13.8539 \n",
      "         R36            >            0            0            0            0      13.8539 \n",
      "         R37            >            0            0            0            0      13.8539 \n",
      "         R38            >            0            0            0            0      181.329 \n",
      "         R39            >            0            0            0            0      33.9767 \n",
      "         R40            >            0            0            0            0      181.329 \n",
      "         R41            >            0            0            0            0          inf \n",
      "         R42            >            0            0            0            0          inf \n",
      "         R43            >            0            0            0            0          inf \n",
      "         R44            >            0            0            0            0       91.947 \n",
      "         R45            >            0            0            0            0      81.1168 \n",
      "         R46            >     -10.7281            0            0         -inf      10.7281 \n",
      "         R47            >            0            0            0            0      10.7281 \n",
      "         R48            >            0            0            0            0      10.7281 \n",
      "         R49            >            0            0            0            0      10.7281 \n",
      "         R50            >            0            0            0            0      10.7281 \n",
      "         R51            >            0            0            0            0      10.7281 \n",
      "         R52            >            0            0            0            0      10.7281 \n",
      "         R53            >            0            0            0            0      10.7281 \n",
      "         R54            >            0            0            0            0      20.7131 \n",
      "         R55            >            0            0            0            0      20.7131 \n",
      "         R56            >     -20.7131            0            0         -inf      20.7131 \n",
      "         R57            >            0            0            0            0      20.7131 \n",
      "         R58            >            0            0            0            0      20.7131 \n",
      "         R59            >            0            0            0            0      20.7131 \n",
      "         R60            >            0            0            0            0      20.7131 \n",
      "         R61            >            0            0            0            0      20.7131 \n",
      "         R62            >            0            0      275.607      94.2775      283.781 \n",
      "         R63            >     -181.329            0      59.0339         -inf      240.363 \n",
      "         R64            >            0            0      84.2717      50.2951      421.634 \n",
      "         R65            >     -33.9767            0      94.5355         -inf      128.512 \n",
      "         R66            >            0            0       142.78      61.6628      337.625 \n",
      "         R67            >     -81.1168            0      38.4512         -inf      119.568 \n",
      "         R68            >            0            0      138.145      35.5833      138.258 \n",
      "         R69            >     -102.562            0      35.1796         -inf      137.742 \n",
      "         R70            >            0            0      140.791      17.8307       315.92 \n",
      "         R71            >      -122.96            0      29.1193         -inf       152.08 \n",
      "         R72            <      8.17486            0      283.781      275.607          inf \n",
      "         R73            <      240.088            0      480.451      240.363          inf \n",
      "         R74            <      337.362            0      421.634      84.2717          inf \n",
      "         R75            <      385.193            0      513.705      128.512          inf \n",
      "         R76            <      194.845            0      337.625       142.78          inf \n",
      "         R77            <      307.482            0       427.05      119.568          inf \n",
      "         R78            <     0.113176            0      138.258      138.145          inf \n",
      "         R79            <       91.947            0      229.689      137.742          inf \n",
      "         R80            <      175.129            0       315.92      140.791          inf \n",
      "         R81            <      277.377            0      429.456       152.08          inf \n",
      "    CArtL_C0            >     -275.607            0            0         -inf      275.607 \n",
      "    CArtL_C1            >     -240.363            0            0         -inf      240.363 \n",
      "    CArtL_C2            >     -84.2717            0            0         -inf      84.2717 \n",
      "    CArtL_C3            >     -128.512            0            0         -inf      128.512 \n",
      "    CArtL_C4            >      -142.78            0            0         -inf       142.78 \n",
      "    CArtL_C5            >     -119.568            0            0         -inf      119.568 \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "    CArtL_C6            >     -138.145            0            0         -inf      138.145 \n",
      "    CArtL_C7            >     -137.742            0            0         -inf      137.742 \n",
      "    CArtL_C8            >     -140.791            0            0         -inf      140.791 \n",
      "    CArtL_C9            >      -152.08            0            0         -inf       152.08 \n",
      "   CArtL_C10            >           -0            0            0         -inf            0 \n",
      "   CArtL_C11            >           -0            0            0         -inf            0 \n",
      "   CArtL_C12            >           -0            0            0         -inf            0 \n",
      "   CArtL_C13            >     -39.8556            0            0         -inf      39.8556 \n",
      "   CArtL_C14            >           -0            0            0         -inf            0 \n",
      "   CArtL_C15            >           -0            0            0         -inf            0 \n",
      "   CArtL_C16            >           -0            0            0         -inf            0 \n",
      "   CArtL_C17            >           -0            0            0         -inf            0 \n",
      "   CArtL_C18            >           -0            0            0         -inf            0 \n",
      "   CArtL_C19            >           -0            0            0         -inf            0 \n",
      "   CArtL_C20            >           -0            0            0         -inf            0 \n",
      "   CArtL_C21            >     -13.8539            0            0         -inf      13.8539 \n",
      "   CArtL_C22            >           -0            0            0         -inf            0 \n",
      "   CArtL_C23            >           -0            0            0         -inf            0 \n",
      "   CArtL_C24            >           -0            0            0         -inf            0 \n",
      "   CArtL_C25            >           -0            0            0         -inf            0 \n",
      "   CArtL_C26            >           -0            0            0         -inf            0 \n",
      "   CArtL_C27            >           -0            0            0         -inf            0 \n",
      "   CArtL_C28            >           -0            0            0         -inf            0 \n",
      "   CArtL_C29            >           -0            0            0         -inf            0 \n",
      "   CArtL_C30            >           -0            0            0         -inf            0 \n",
      "   CArtL_C31            >           -0            0            0         -inf            0 \n",
      "   CArtL_C32            >           -0            0            0         -inf            0 \n",
      "   CArtL_C33            >           -0            0            0         -inf            0 \n",
      "   CArtL_C34            >     -10.7281            0            0         -inf      10.7281 \n",
      "   CArtL_C35            >           -0            0            0         -inf            0 \n",
      "   CArtL_C36            >           -0            0            0         -inf            0 \n",
      "   CArtL_C37            >           -0            0            0         -inf            0 \n",
      "   CArtL_C38            >           -0            0            0         -inf            0 \n",
      "   CArtL_C39            >           -0            0            0         -inf            0 \n",
      "   CArtL_C40            >           -0            0            0         -inf            0 \n",
      "   CArtL_C41            >           -0            0            0         -inf            0 \n",
      "   CArtL_C42            >           -0            0            0         -inf            0 \n",
      "   CArtL_C43            >           -0            0            0         -inf            0 \n",
      "   CArtL_C44            >           -0            0            0         -inf            0 \n",
      "   CArtL_C45            >           -0            0            0         -inf            0 \n",
      "   CArtL_C46            >     -20.7131            0            0         -inf      20.7131 \n",
      "   CArtL_C47            >           -0            0            0         -inf            0 \n",
      "   CArtL_C48            >           -0            0            0         -inf            0 \n",
      "   CArtL_C49            >           -0            0            0         -inf            0 \n"
     ]
    }
   ],
   "source": [
    "# sensitivity analysis for the constraints\n",
    "M.printAttr(['Sense', 'Slack', 'Pi', 'RHS', 'SARHSLow', 'SARHSUp'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "68b5fb04",
   "metadata": {},
   "source": [
    "#### Conclusion:\n",
    "As we can see from the sensitivity analysis above (R0 & R1), our optimal solution will not change even if we increase the number of bikes infinitely. Since infitnite increase of bikes does not change the total number of transports, it isn’t worth it to explore an expansion in resources from a financial (profit optimization) perspective. However, if for some reasons, we have to decrease the number of bikes we have, the maximum amount of bikes can be decreased before the our optimal solution changes are 781 bikes for the morning time period, and 778 bikes for the night time period."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1048c084",
   "metadata": {},
   "source": [
    "#### 2) To increase the precision of the logistic scheme, we conducted a sensitivity analysis to determine how to the optimal schedule changes by adding another time section (“afternoon”):"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2dfd737a",
   "metadata": {},
   "source": [
    "#### Re-running the model after adding another time section\n",
    "Our time sections are as follows:\\\n",
    "Morning (from 5AM to 12PM)\\\n",
    "Afternoon (from 1PM to 8PM)\\\n",
    "Night (from 9PM to 4AM)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "0f06e3cd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>time</th> <th>35</th> <th>192</th> <th>76</th> <th>177</th> <th>268</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>morning  </td> <td>85.9661</td> <td>98.0275</td> <td>54.8364</td> <td>47.7143</td> <td>40.4294</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>afternoon</td> <td>229.322</td> <td>77.8907</td> <td>116.164</td> <td>119.921</td> <td>121.74 </td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>night    </td> <td>25.5379</td> <td>4.2071 </td> <td>15.3828</td> <td>8.73944</td> <td>9.37762</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "time      | 35      | 192     | 76      | 177     | 268\n",
       "morning   | 85.9661 | 98.0275 | 54.8364 | 47.7143 | 40.4294\n",
       "afternoon | 229.322 | 77.8907 | 116.164 | 119.921 | 121.74\n",
       "night     | 25.5379 | 4.2071  | 15.3828 | 8.73944 | 9.37762"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "busiest_origin_stations_traffic = Table().with_columns('id', busiest_origin_stations.take(np.arange(5)).column('id')).join('id', trips.select('from_station_id', 'start_time'), 'from_station_id')\n",
    "date_array = [\"\" for i in range(busiest_origin_stations_traffic.num_rows)]\n",
    "time_array = [\"\" for i in range(busiest_origin_stations_traffic.num_rows)]\n",
    "for i in np.arange(busiest_origin_stations_traffic.num_rows):\n",
    "    date_array[i] = busiest_origin_stations_traffic.column('start_time')[i].split(' ')[0]\n",
    "    t = int(busiest_origin_stations_traffic.column('start_time')[i].split(' ')[1].split(':')[0])\n",
    "    if (5 <= t <= 12):\n",
    "        time_array[i] = 'morning'\n",
    "    elif (13 <= t <= 20):\n",
    "        time_array[i] = 'afternoon'\n",
    "    elif (t >= 21 or t <= 4):\n",
    "        time_array[i] = 'night'\n",
    "busiest_origin_stations_traffic = busiest_origin_stations_traffic.with_columns('date', date_array, 'time', time_array).group(['id','date', 'time'])\n",
    "U_ijt = Table().with_column('time', ['morning', 'afternoon', 'night'])\n",
    "traffic_count = np.zeros(len(U_ijt.column('time')))\n",
    "def avg_traffic(id):\n",
    "    global U_ijt\n",
    "    for i in np.arange(len(U_ijt.column('time'))):\n",
    "        count = busiest_origin_stations_traffic.where('id', id).where('time', U_ijt[0][i]).column('count')\n",
    "        traffic_count[i] = sum(count)/len(count)\n",
    "    U_ijt = U_ijt.with_column(str(id), [traffic_count[0], traffic_count[1], traffic_count[2]])\n",
    "for i in np.arange(busiest_origin_stations.take(np.arange(5)).num_rows):\n",
    "    avg_traffic(busiest_origin_stations.take(np.arange(5)).column('id')[i])\n",
    "U_ijt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "52401991",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table border=\"1\" class=\"dataframe\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>time</th> <th>35</th> <th>192</th> <th>268</th> <th>177</th> <th>76</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>morning  </td> <td>117.764</td> <td>53.5326</td> <td>55.5   </td> <td>63.4438</td> <td>55.3354</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>afternoon</td> <td>236.066</td> <td>135.665</td> <td>129.074</td> <td>115.655</td> <td>109.017</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>night    </td> <td>16.0692</td> <td>4.39264</td> <td>8.86232</td> <td>7.72993</td> <td>10.8667</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "time      | 35      | 192     | 268     | 177     | 76\n",
       "morning   | 117.764 | 53.5326 | 55.5    | 63.4438 | 55.3354\n",
       "afternoon | 236.066 | 135.665 | 129.074 | 115.655 | 109.017\n",
       "night     | 16.0692 | 4.39264 | 8.86232 | 7.72993 | 10.8667"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "busiest_dest_stations_traffic = Table().with_columns('id', busiest_dest_stations.take(np.arange(5)).column('id')).join('id', trips.select('to_station_id', 'start_time'), 'to_station_id')\n",
    "date_array = [\"\" for i in range(busiest_dest_stations_traffic.num_rows)]\n",
    "time_array = [\"\" for i in range(busiest_dest_stations_traffic.num_rows)]\n",
    "for i in np.arange(busiest_dest_stations_traffic.num_rows):\n",
    "    date_array[i] = busiest_dest_stations_traffic.column('start_time')[i].split(' ')[0]\n",
    "    t = int(busiest_dest_stations_traffic.column('start_time')[i].split(' ')[1].split(':')[0])\n",
    "    if (5 <= t <= 12):\n",
    "        time_array[i] = 'morning'\n",
    "    elif (13 <= t <= 20):\n",
    "        time_array[i] = 'afternoon'\n",
    "    elif (t >= 21 or t <= 4):\n",
    "        time_array[i] = 'night'\n",
    "busiest_dest_stations_traffic = busiest_dest_stations_traffic.with_columns('date', date_array, 'time', time_array).group(['id','date', 'time'])\n",
    "busiest_dest_stations_traffic\n",
    "U_jit = Table().with_column('time', ['morning', 'afternoon', 'night'])\n",
    "traffic_count = np.zeros(len(U_jit.column('time')))\n",
    "def avg_traffic(id):\n",
    "    global U_jit \n",
    "    for i in np.arange(len(U_jit .column('time'))):\n",
    "        count = busiest_dest_stations_traffic.where('id', id).where('time', U_jit[0][i]).column('count')\n",
    "        traffic_count[i] = sum(count)/len(count)\n",
    "    U_jit = U_jit .with_column(str(id), [traffic_count[0], traffic_count[1], traffic_count[2]])\n",
    "for i in np.arange(busiest_dest_stations.take(np.arange(5)).num_rows):\n",
    "    avg_traffic(busiest_dest_stations.take(np.arange(5)).column('id')[i])\n",
    "U_jit"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "51e0e69d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "33084.0"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# A is the number of bikes available for each time period (8 hours each)\n",
    "A = len(np.unique(trips.column('bikeid')))*8\n",
    "\n",
    "# Set the a fixed number of bikes for all the stations that are not included in the model (20%)\n",
    "array = stations.column('dpcapacity')*8*0.2 \n",
    "\n",
    "fixed_num_of_bikes = Table().with_columns('id', stations.column('id'),\n",
    "                                             'fixed number of bikes', [int(x) for x in array])\n",
    "five_busiest_stations = np.zeros(5)\n",
    "# extracting the set number of bikes for 5 busiest stations\n",
    "for i in np.arange(5):\n",
    "    five_busiest_stations[i] = fixed_num_of_bikes.where('id', are.equal_to(busiest_origin_stations.take(np.arange(5)).column('id')[i])).column('fixed number of bikes')[0]\n",
    "\n",
    "# A equals to the total amount of unique bikes minus the total number of bikes set for all stations \n",
    "# plus the fixed amount of bikes set for 5 busiest stations\n",
    "A = A - sum(fixed_num_of_bikes.column('fixed number of bikes')) + sum(five_busiest_stations) \n",
    "A"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "e3598dd1",
   "metadata": {},
   "outputs": [],
   "source": [
    "S = busiest_origin_stations.take(np.arange(5)).column('id')\n",
    "T = ['morning', 'afternoon','night']\n",
    "\n",
    "B = {} # optimal number of bikes at a station \n",
    "X = {} # optimal number of bikes to be repositioned\n",
    "B = M.addVars(S,T)\n",
    "X = M.addVars([(i,j,t) for i in S for j in S if i!=j for t in T])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "3728cc95",
   "metadata": {},
   "outputs": [],
   "source": [
    "#1st constraint\n",
    "M.addConstrs(quicksum(B[i,t] for i in S) <= A for t in T)\n",
    "#3rd constraint\n",
    "for t in T:\n",
    "    if (t == \"morning\"):\n",
    "        t_minusone = \"night\"\n",
    "        for i in S:\n",
    "            M.addConstr(B[i,t] == B[i,t_minusone] + quicksum(X[j,i,t] for j in S if i!=j) + U_jit.column(str(i))[0] - quicksum(X[i,j,t] for j in S if i!=j) - U_ijt.column(str(i))[0])\n",
    "    elif (t == \"afternoon\"):\n",
    "        t_minusone = \"morning\"\n",
    "        for i in S:\n",
    "            M.addConstr(B[i,t] == B[i,t_minusone] + quicksum(X[j,i,t] for j in S if i!=j) + U_jit.column(str(i))[1] - quicksum(X[i,j,t] for j in S if i!=j) - U_ijt.column(str(i))[1])\n",
    "    elif (t == \"night\"):\n",
    "        t_minusone = \"afternoon\"\n",
    "        for i in S:\n",
    "            M.addConstr(B[i,t] == B[i,t_minusone] + quicksum(X[j,i,t] for j in S if i!=j) + U_jit.column(str(i))[2] - quicksum(X[i,j,t] for j in S if i!=j) - U_ijt.column(str(i))[2])\n",
    "#4th constraint\n",
    "for i in S:\n",
    "    for t in T:\n",
    "        for j in S:\n",
    "            if (i != j):\n",
    "                M.addConstr(X[i,j,t] >= 0)\n",
    "#5th constraint\n",
    "for i in S:\n",
    "    for t in T:\n",
    "        if (t == 'morning'):\n",
    "            M.addConstr(B[i,t] >= U_ijt.column(str(i))[1]) #t+1\n",
    "        elif (t == 'afternoon'):\n",
    "            M.addConstr(B[i,t] >= U_ijt.column(str(i))[2])\n",
    "        elif (t == 'night'):\n",
    "            M.addConstr(B[i,t] >= U_ijt.column(str(i))[0])\n",
    "#6th constraint\n",
    "for i in S:\n",
    "    capacity = int(C.where('id', i).column('dpcapacity')[0])\n",
    "    for t in T:\n",
    "        if (t == 'morning'):\n",
    "            M.addConstr(B[i,t] <= capacity*8 - U_jit.column(str(i))[1]) #t+1\n",
    "        elif (t == 'afternoon'):\n",
    "            M.addConstr(B[i,t] <= capacity*8 - U_jit.column(str(i))[2])\n",
    "        elif (t == 'night'):\n",
    "            M.addConstr(B[i,t] >= U_ijt.column(str(i))[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "08991ef3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (mac64[x86])\n",
      "Thread count: 4 physical cores, 8 logical processors, using up to 8 threads\n",
      "Optimize a model with 240 rows, 267 columns and 627 nonzeros\n",
      "Coefficient statistics:\n",
      "  Matrix range     [1e+00, 1e+00]\n",
      "  Objective range  [1e+00, 5e+00]\n",
      "  Bounds range     [0e+00, 0e+00]\n",
      "  RHS range        [2e-01, 5e+04]\n",
      "Iteration    Objective       Primal Inf.    Dual Inf.      Time\n",
      "       0    0.0000000e+00   1.588782e+03   0.000000e+00      0s\n",
      "\n",
      "Solved in 15 iterations and 0.00 seconds (0.00 work units)\n",
      "Infeasible model\n"
     ]
    }
   ],
   "source": [
    "z = quicksum(X[j,i,t]*D.where(\"id\", i).column(str(j))[0] for t in T for i in S for j in S if i!=j)\n",
    "M.setObjective(z, GRB.MINIMIZE)\n",
    "M.update()\n",
    "M.optimize()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "db072b62",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (mac64[x86])\n",
      "Thread count: 4 physical cores, 8 logical processors, using up to 8 threads\n",
      "Optimize a model with 457 rows, 749 columns and 1326 nonzeros\n",
      "Coefficient statistics:\n",
      "  Matrix range     [1e+00, 1e+00]\n",
      "  Objective range  [1e+00, 1e+00]\n",
      "  Bounds range     [0e+00, 0e+00]\n",
      "  RHS range        [2e-01, 5e+04]\n",
      "Iteration    Objective       Primal Inf.    Dual Inf.      Time\n",
      "       0      handle free variables                          0s\n",
      "     210    2.0468198e+02   0.000000e+00   0.000000e+00      0s\n",
      "\n",
      "Solved in 210 iterations and 0.01 seconds (0.00 work units)\n",
      "Optimal objective  2.046819750e+02\n"
     ]
    }
   ],
   "source": [
    "M.feasRelaxS(0, False, True, True)\n",
    "M.optimize()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "506a0c50",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Minimum value of the objective function is:  204.68197503486695\n"
     ]
    }
   ],
   "source": [
    "print(\"Minimum value of the objective function is: \",M.objVal)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "7f02eb6e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The number bikes at station (35, 'morning') is: 230\n",
      "The number bikes at station (35, 'afternoon') is: 237\n",
      "The number bikes at station (35, 'night') is: 198\n",
      "The number bikes at station (192, 'morning') is: 78\n",
      "The number bikes at station (192, 'afternoon') is: 136\n",
      "The number bikes at station (192, 'night') is: 187\n",
      "The number bikes at station (76, 'morning') is: 117\n",
      "The number bikes at station (76, 'afternoon') is: 110\n",
      "The number bikes at station (76, 'night') is: 116\n",
      "The number bikes at station (177, 'morning') is: 120\n",
      "The number bikes at station (177, 'afternoon') is: 116\n",
      "The number bikes at station (177, 'night') is: 105\n",
      "The number bikes at station (268, 'morning') is: 122\n",
      "The number bikes at station (268, 'afternoon') is: 130\n",
      "The number bikes at station (268, 'night') is: 107\n"
     ]
    }
   ],
   "source": [
    "for i in B:\n",
    "    print(\"The number bikes at station\", i, \"is:\", math.ceil(B[i].X))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "db71aabe",
   "metadata": {},
   "source": [
    "***\n",
    "The optimal number of bikes at the 5 busiest stations in each time period is\n",
    "\n",
    "| Time    |35 |192|76 |177|268|\n",
    "|:--------|---|---|---|---|---|\n",
    "|Morning  |230|78 |117|120|122|\n",
    "|Afternoon|237|136|110 |116  |130 |\n",
    "|Night    |198|187 |116 |105 |107 |"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "204339c0",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The number bikes of to be repositioned  (35, 76, 'night') is: 30\n",
      "The number bikes of to be repositioned  (76, 177, 'night') is: 18\n",
      "The number bikes of to be repositioned  (177, 268, 'night') is: 29\n",
      "The number bikes of to be repositioned  (268, 192, 'night') is: 51\n"
     ]
    }
   ],
   "source": [
    "for i in X:\n",
    "    if (X[i].X != 0):\n",
    "        print(\"The number bikes of to be repositioned \", i, \"is:\", math.ceil(X[i].X))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4570bf51",
   "metadata": {},
   "source": [
    "#### Conlusion:\n",
    "As we can see from results, the minimum value of the objective function increases by 317% when adding an additional time consideration. Eventhough the access to bikes in near stations is the most important part of customer satisfaction, the high percentage increase in our optimal function suggest it wouldn’t be worth it to add a new time section. However, no conclusion can be made without the financial breakdown of costs and the potential change in the cashflow projections to determine the profitability of adding a new time section."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1e9f53e8",
   "metadata": {},
   "source": [
    "# CONCLUSION"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a11276df",
   "metadata": {},
   "source": [
    "To summarize, this study aimed to provide an optimal logistic scheme for DIVVY’s transport services. This was achieved through an exploration of the data to determine the constraints and the selection of the decision variables explained above. After optimizing the relaxed version of the model, we found the optimal value for the number of bikes to be reposition from a given station. Furthermore, a sensitivity analysis was conducted to explore the changes in the number of transports when the constraint for the number of bikes was altered. Additional financial data is required to confirm the managerial recommendations, such as the cost of acquiring or manufacturing new bikes and the projected operational revenue, but according to our initial evaluation increasing the number of bikes available wouldn’t be practical for the company as there will be no change in the number of repositioning operations. Moreover, the huge increase in the value of objective function (317%) also doesn't justify the addition of a new time section.\\\n",
    "As next steps, we suggest increasing the computational resources to expand the study to all stations available, to create a general transport scheme. "
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
